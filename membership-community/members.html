<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Member Hub - Ray Paull Pickleball</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/members.css">
    <link rel="preconnect" href="https://jrwgmyksopkuylknwwhp.supabase.co">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Config & API -->
    <script src="../js/config.js"></script>
    <script src="../js/api-client.js"></script>
    <!-- Gamification & Social -->
    <script src="../js/gamification.js"></script>
    <script src="../js/social.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="../index.html">Ray's Pickleball</a>
            </div>
            <ul class="nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../about.html">About</a></li>
                <li><a href="../services.html">Services</a></li>
                <li><a href="../pricing.html">Pricing</a></li>
                <li><a href="community.html">Community</a></li>
                <li><a href="membership.html">Membership</a></li>
                <li><a href="../coach-analysis/video-analysis.html">Submit Video</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <h1>Member Hub</h1>
            <p>Your profile, challenges, and community connections</p>
        </section>

        <!-- TAB NAVIGATION -->
        <div class="tab-navigation">
            <div class="container">
                <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
                <button class="tab-btn" data-tab="profile">My Profile</button>
                <button class="tab-btn" data-tab="challenges">Challenges</button>
                <button class="tab-btn" data-tab="progress">Progress</button>
                <button class="tab-btn" data-tab="partners">Find Partners</button>
                <button class="tab-btn" data-tab="leaderboard">Leaderboard</button>
            </div>
        </div>

        <!-- NOT LOGGED IN STATE -->
        <div class="not-logged-in" id="notLoggedIn">
            <div class="container">
                <div class="login-prompt">
                    <h2>Members Only</h2>
                    <p>Log in with your member email to access the Member Hub.</p>
                    <form id="hubLoginForm" class="hub-login-form">
                        <input type="email" id="hubLoginEmail" placeholder="Your member email" required>
                        <button type="submit" class="btn btn-primary">Log In</button>
                    </form>
                    <p class="login-subtext">Not a member yet? <a href="membership.html">Join for $19.99/mo</a></p>
                </div>
            </div>
        </div>

        <!-- LOGGED IN CONTENT -->
        <div class="member-content" id="memberContent" style="display: none;">
            <div class="container">

                <!-- GAMIFICATION DASHBOARD TAB -->
                <div class="tab-content active" id="dashboard-tab">
                    <!-- Daily Check-in Banner -->
                    <div class="checkin-banner" id="checkinBanner">
                        <div class="checkin-content">
                            <div class="checkin-greeting">
                                <h2>Welcome back! <span id="welcomeName"></span></h2>
                                <p id="checkinMessage">Check in daily to build your streak!</p>
                            </div>
                            <button class="btn btn-primary checkin-btn" id="checkinBtn">
                                <span class="btn-icon">üî•</span> Check In Today
                            </button>
                        </div>
                    </div>

                    <!-- XP Bar & Stats Overview -->
                    <div class="dashboard-grid">
                        <div class="dashboard-main">
                            <!-- XP Progress Bar -->
                            <div id="xpBarContainer"></div>

                            <!-- Stats Overview Cards -->
                            <div id="statsOverviewContainer"></div>

                            <!-- Streak Calendar -->
                            <div id="streakCalendarContainer"></div>

                            <!-- Recent Activity -->
                            <div class="recent-activity-section">
                                <h3>üïê Your Recent Activity</h3>
                                <div id="recentXPContainer" class="recent-xp-list">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-sidebar">
                            <!-- Badges Preview -->
                            <div id="badgesContainer"></div>

                            <!-- Quick Actions -->
                            <div class="quick-actions-card">
                                <h4>Quick Actions</h4>
                                <a href="../coach-analysis/video-analysis.html" class="quick-action-btn">
                                    <span>üé¨</span> Submit Video
                                </a>
                                <a href="../ai-drill-coach/drills-library.html" class="quick-action-btn">
                                    <span>üèÉ</span> Practice Drills
                                </a>
                                <button class="quick-action-btn" onclick="switchTab('partners')">
                                    <span>ü§ù</span> Find Partners
                                </button>
                                <button class="quick-action-btn" onclick="switchTab('challenges')">
                                    <span>üèÜ</span> View Challenges
                                </button>
                            </div>

                            <!-- Community Activity Feed -->
                            <div id="activityFeedContainer"></div>
                        </div>
                    </div>
                </div>

                <!-- MY PROFILE TAB -->
                <div class="tab-content" id="profile-tab">
                    <div class="profile-section">
                        <div class="profile-header">
                            <div class="profile-photo" id="profilePhoto">
                                <span class="photo-placeholder">üì∑</span>
                            </div>
                            <div class="profile-info">
                                <h2 id="profileName">Your Name</h2>
                                <p class="profile-location" id="profileLocation">City, State</p>
                                <div class="profile-badges" id="profileBadges">
                                    <!-- Badges populated by JS -->
                                </div>
                            </div>
                            <button class="btn btn-secondary" id="editProfileBtn">Edit Profile</button>
                        </div>

                        <!-- Profile Completion Progress -->
                        <div class="profile-completion" id="profileCompletion">
                            <div class="completion-header">
                                <span class="completion-label">Profile Completion</span>
                                <span class="completion-percent" id="completionPercent">0%</span>
                            </div>
                            <div class="completion-bar">
                                <div class="completion-fill" id="completionFill"></div>
                            </div>
                            <div class="completion-items" id="completionItems">
                                <span class="completion-item done" data-field="name">‚úì Name</span>
                                <span class="completion-item" data-field="photo">üì∑ Photo</span>
                                <span class="completion-item" data-field="location">üìç Location</span>
                                <span class="completion-item" data-field="dupr">üéØ DUPR</span>
                                <span class="completion-item" data-field="style">üèì Style</span>
                                <span class="completion-item" data-field="availability">üìÖ Availability</span>
                            </div>
                            <p class="completion-reward" id="completionReward">Complete your profile to earn <strong>+10 points</strong>!</p>
                        </div>

                        <!-- GETTING STARTED CHECKLIST -->
                        <div class="getting-started-section" id="gettingStarted">
                            <div class="getting-started-card">
                                <div class="gs-header">
                                    <h3>üöÄ Getting Started</h3>
                                    <span class="gs-progress" id="gsProgress">0/5 Complete</span>
                                </div>
                                <p class="gs-subtitle">Complete these steps to get the most out of your membership!</p>

                                <div class="gs-checklist">
                                    <div class="gs-item" id="gsProfile" data-step="1">
                                        <div class="gs-checkbox">
                                            <span class="gs-check">‚úì</span>
                                        </div>
                                        <div class="gs-content">
                                            <h4>Step 1: Complete Your Profile</h4>
                                            <p>Add your photo, DUPR rating, and playing style so others can find you.</p>
                                            <button class="btn btn-small btn-primary gs-action" onclick="document.getElementById('editProfileBtn').click()">Complete Profile ‚Üí</button>
                                        </div>
                                        <span class="gs-points">+10 pts</span>
                                    </div>

                                    <div class="gs-item" id="gsChallenge" data-step="2">
                                        <div class="gs-checkbox">
                                            <span class="gs-check">‚úì</span>
                                        </div>
                                        <div class="gs-content">
                                            <h4>Step 2: Complete Your First Challenge</h4>
                                            <p>Practice this week's drill and upload a video to earn points.</p>
                                            <button class="btn btn-small btn-primary gs-action" onclick="switchTab('challenges')">View Challenge ‚Üí</button>
                                        </div>
                                        <span class="gs-points">+15 pts</span>
                                    </div>

                                    <div class="gs-item" id="gsContest" data-step="3">
                                        <div class="gs-checkbox">
                                            <span class="gs-check">‚úì</span>
                                        </div>
                                        <div class="gs-content">
                                            <h4>Step 3: Submit to Weekly Contest</h4>
                                            <p>Show off your skills! Upload a video to the community contest.</p>
                                            <a href="community.html" class="btn btn-small btn-primary gs-action">Go to Contest ‚Üí</a>
                                        </div>
                                        <span class="gs-points">+20 pts</span>
                                    </div>

                                    <div class="gs-item" id="gsVote" data-step="4">
                                        <div class="gs-checkbox">
                                            <span class="gs-check">‚úì</span>
                                        </div>
                                        <div class="gs-content">
                                            <h4>Step 4: Vote for Your Favorite</h4>
                                            <p>Support fellow members by voting for the best video this week.</p>
                                            <a href="community.html#gallery" class="btn btn-small btn-primary gs-action">Vote Now ‚Üí</a>
                                        </div>
                                        <span class="gs-points">+2 pts</span>
                                    </div>

                                    <div class="gs-item" id="gsRefer" data-step="5">
                                        <div class="gs-checkbox">
                                            <span class="gs-check">‚úì</span>
                                        </div>
                                        <div class="gs-content">
                                            <h4>Step 5: Invite a Friend</h4>
                                            <p>Share your referral code with friends who love pickleball!</p>
                                            <button class="btn btn-small btn-primary gs-action" onclick="document.getElementById('referralSection').scrollIntoView({behavior: 'smooth'})">Get Code ‚Üí</button>
                                        </div>
                                        <span class="gs-points">+50 pts</span>
                                    </div>
                                </div>

                                <div class="gs-footer">
                                    <p>üéâ Complete all 5 steps to earn the <strong>"Quick Start"</strong> badge!</p>
                                    <button class="btn btn-text" id="hideGettingStarted">I'll explore on my own</button>
                                </div>
                            </div>
                        </div>

                        <div class="profile-stats">
                            <div class="stat-box points-box">
                                <span class="stat-value" id="statPoints">0</span>
                                <span class="stat-label">Points</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-value" id="statDupr">--</span>
                                <span class="stat-label">DUPR</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-value" id="statWins">0</span>
                                <span class="stat-label">Contest Wins</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-value" id="statStreak">0</span>
                                <span class="stat-label">Week Streak</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-value" id="statChallenges">0</span>
                                <span class="stat-label">Challenges Done</span>
                            </div>
                        </div>

                        <div class="profile-details">
                            <div class="detail-section">
                                <h3>About Me</h3>
                                <p id="profileBio">Add a bio to tell others about yourself!</p>
                            </div>
                            <div class="detail-section">
                                <h3>Playing Style</h3>
                                <p id="profileStyle">--</p>
                            </div>
                            <div class="detail-section">
                                <h3>Home Courts</h3>
                                <p id="profileCourts">--</p>
                            </div>
                            <div class="detail-section">
                                <h3>Availability</h3>
                                <p id="profileAvailability">--</p>
                            </div>
                            <div class="detail-section">
                                <h3>Connect</h3>
                                <p id="profileSocial">--</p>
                            </div>
                        </div>

                        <!-- Quick Poll -->
                        <div class="quick-poll-section" id="quickPollSection">
                            <div class="quick-poll-card">
                                <h3>üìä Quick Poll</h3>
                                <p class="poll-question" id="pollQuestion">What's your biggest weakness?</p>
                                <div class="poll-options" id="pollOptions">
                                    <!-- Populated by JS -->
                                </div>
                                <div class="poll-results" id="pollResults" style="display: none;">
                                    <h4>Results</h4>
                                    <div class="results-bars" id="resultsBar"></div>
                                    <p class="total-votes" id="totalVotes">0 total votes</p>
                                </div>
                            </div>
                        </div>

                        <!-- Partner Match Suggestions -->
                        <div class="partner-match-section" id="partnerMatchSection">
                            <div class="partner-match-card">
                                <h3>ü§ù Suggested Partners</h3>
                                <p class="match-subtitle">Members with similar skill level and availability</p>
                                <div class="match-list" id="matchList">
                                    <!-- Populated by JS -->
                                    <p class="no-matches">Complete your profile to see partner suggestions!</p>
                                </div>
                            </div>
                        </div>

                        <!-- Enhanced Referral Section -->
                        <div class="referral-section" id="referralSection">
                            <div class="referral-card">
                                <div class="referral-header">
                                    <h3>üéÅ Refer Friends & Earn Rewards</h3>
                                    <div class="ambassador-badge-legendary" id="ambassadorBadge" style="display: none;">
                                        <span class="ambassador-star">‚≠ê</span>
                                        <span>AMBASSADOR</span>
                                    </div>
                                </div>

                                <!-- Tier Progress Visualization -->
                                <div class="tier-progress">
                                    <div class="tier-progress-header">
                                        <span class="progress-label">Your Referral Progress</span>
                                        <span class="progress-count" id="referralProgressCount">0/15 to Ambassador</span>
                                    </div>
                                    <div class="tier-progress-bar">
                                        <div class="tier-markers">
                                            <div class="tier-marker" data-tier="1" data-req="1"><span>1</span></div>
                                            <div class="tier-marker" data-tier="2" data-req="3"><span>3</span></div>
                                            <div class="tier-marker" data-tier="3" data-req="5"><span>5</span></div>
                                            <div class="tier-marker" data-tier="4" data-req="10"><span>10</span></div>
                                            <div class="tier-marker ambassador-marker" data-tier="5" data-req="15"><span>15</span></div>
                                        </div>
                                        <div class="tier-track">
                                            <div class="tier-fill" id="tierFill" style="width: 0%;"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Rewards Tiers -->
                                <div class="rewards-tiers" id="rewardsTiers">
                                    <div class="tier-row" data-tier="1">
                                        <span class="tier-icon">üéØ</span>
                                        <div class="tier-info">
                                            <span class="tier-name">1 Referral</span>
                                            <span class="tier-reward">$5 off next month</span>
                                        </div>
                                        <span class="tier-status" id="tier1Status">Locked</span>
                                    </div>
                                    <div class="tier-row" data-tier="2">
                                        <span class="tier-icon">üåü</span>
                                        <div class="tier-info">
                                            <span class="tier-name">3 Referrals</span>
                                            <span class="tier-reward">Free month membership</span>
                                        </div>
                                        <span class="tier-status" id="tier2Status">Locked</span>
                                    </div>
                                    <div class="tier-row" data-tier="3">
                                        <span class="tier-icon">üé¨</span>
                                        <div class="tier-info">
                                            <span class="tier-name">5 Referrals</span>
                                            <span class="tier-reward">Free 30-min video analysis ($75)</span>
                                        </div>
                                        <span class="tier-status" id="tier3Status">Locked</span>
                                    </div>
                                    <div class="tier-row" data-tier="4">
                                        <span class="tier-icon">üèÜ</span>
                                        <div class="tier-info">
                                            <span class="tier-name">10 Referrals</span>
                                            <span class="tier-reward">Free 60-min video analysis ($120)</span>
                                        </div>
                                        <span class="tier-status" id="tier4Status">Locked</span>
                                    </div>
                                    <div class="tier-row ambassador-tier" data-tier="5">
                                        <span class="tier-icon">‚≠ê</span>
                                        <div class="tier-info">
                                            <span class="tier-name">15 Referrals</span>
                                            <span class="tier-reward">AMBASSADOR: Permanent 10% off everything!</span>
                                        </div>
                                        <span class="tier-status" id="tier5Status">Locked</span>
                                    </div>
                                </div>

                                <!-- Pending Referrals Section -->
                                <div class="pending-referrals" id="pendingReferrals" style="display: none;">
                                    <h4>‚è≥ Pending Confirmations</h4>
                                    <p class="pending-note">Referrals confirm after friend stays 1 month</p>
                                    <div class="pending-list" id="pendingReferralsList"></div>
                                </div>

                                <!-- Referral Code Box -->
                                <div class="referral-code-box">
                                    <span class="referral-label">Your Referral Code:</span>
                                    <span class="referral-code" id="referralCode">--</span>
                                    <button class="btn btn-secondary btn-small" onclick="copyReferralCode()">Copy</button>
                                </div>
                                <p class="referral-note">Share this code with friends. They enter it when signing up!</p>

                                <!-- Share Buttons -->
                                <div class="share-buttons">
                                    <button class="btn btn-share" onclick="shareViaText()">üì± Text</button>
                                    <button class="btn btn-share" onclick="shareViaEmail()">üìß Email</button>
                                    <button class="btn btn-share" onclick="copyShareLink()">üîó Copy Link</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- EDIT PROFILE MODAL -->
                    <div class="modal" id="editProfileModal">
                        <div class="modal-content">
                            <h2>Edit Profile</h2>
                            <form id="editProfileForm">
                                <div class="form-group">
                                    <label>Display Name</label>
                                    <input type="text" id="editName" required>
                                </div>
                                <div class="form-group">
                                    <label>Profile Photo URL (optional)</label>
                                    <input type="url" id="editPhoto" placeholder="https://...">
                                    <p class="form-help">Paste a link to your photo (Google Drive, Imgur, etc.)</p>
                                </div>
                                <div class="form-group">
                                    <label>City, State</label>
                                    <input type="text" id="editLocation" placeholder="Phoenix, AZ">
                                </div>
                                <div class="form-group">
                                    <label>DUPR Rating</label>
                                    <input type="text" id="editDupr" placeholder="4.0">
                                </div>
                                <div class="form-group">
                                    <label>Playing Style</label>
                                    <select id="editStyle">
                                        <option value="">Select...</option>
                                        <option value="Aggressive banger">Aggressive banger</option>
                                        <option value="Soft game specialist">Soft game specialist</option>
                                        <option value="All-around player">All-around player</option>
                                        <option value="Counter-puncher">Counter-puncher</option>
                                        <option value="Net rusher">Net rusher</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Preferred Position</label>
                                    <select id="editPosition">
                                        <option value="">Select...</option>
                                        <option value="Left side">Left side</option>
                                        <option value="Right side">Right side</option>
                                        <option value="Either side">Either side</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Home Courts</label>
                                    <input type="text" id="editCourts" placeholder="Kiwanis Park, Paseo Racquet Center">
                                </div>
                                <div class="form-group">
                                    <label>Typical Availability</label>
                                    <input type="text" id="editAvailability" placeholder="Weekday mornings, weekends">
                                </div>
                                <div class="form-group">
                                    <label>About Me</label>
                                    <textarea id="editBio" rows="3" placeholder="Tell others about yourself..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Social Link (for partner finder)</label>
                                    <input type="url" id="editSocial" placeholder="Instagram, Facebook, or other profile URL">
                                    <p class="form-help">This will be visible to other members looking for partners</p>
                                </div>
                                <div class="modal-actions">
                                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
                                    <button type="submit" class="btn btn-primary">Save Profile</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- DRILL CHALLENGES TAB -->
                <div class="tab-content" id="challenges-tab">
                    <div class="challenges-section">
                        <!-- Current Challenge -->
                        <div class="current-challenge">
                            <div class="challenge-badge">This Week's Challenge</div>
                            <h2 id="challengeTitle">Practice 100 Third Shot Drops</h2>
                            <p id="challengeDescription">Focus on soft, controlled drops that land in the kitchen. Quality over speed!</p>
                            <div class="challenge-details">
                                <span><strong>Goal:</strong> <span id="challengeGoal">100 drops</span></span>
                                <span><strong>Ends:</strong> <span id="challengeEnd">Saturday midnight</span></span>
                                <span><strong>Reward:</strong> <span class="points-reward">+15 points</span></span>
                            </div>
                            <div class="challenge-action" id="challengeAction">
                                <button class="btn btn-primary btn-large" id="showUploadForm">Submit Video Proof</button>
                            </div>
                            <p class="challenge-note">Upload a 30-60 second clip showing you doing the drill. Our AI will verify it!</p>
                        </div>

                        <!-- Video Upload Form with Step-by-Step Guide -->
                        <div class="challenge-upload-form" id="challengeUploadForm" style="display: none;">
                            <div class="upload-header">
                                <h3>üìπ Submit Your Challenge Video</h3>
                                <button type="button" class="btn-close" onclick="hideChallengeUpload()">√ó</button>
                            </div>

                            <!-- Step-by-Step Instructions -->
                            <div class="upload-steps">
                                <div class="upload-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <h4>Record Your Video</h4>
                                        <ul class="step-checklist">
                                            <li>‚úì 30-60 seconds long</li>
                                            <li>‚úì Show yourself doing the drill clearly</li>
                                            <li>‚úì Good lighting so we can see the ball</li>
                                            <li>‚úì Horizontal/landscape mode works best</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="upload-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <h4>Upload to Cloud Storage</h4>
                                        <p>Upload your video to one of these free services:</p>
                                        <div class="storage-options">
                                            <span class="storage-badge">üìÅ Google Drive</span>
                                            <span class="storage-badge">üì¶ Dropbox</span>
                                            <span class="storage-badge">‚ñ∂Ô∏è YouTube</span>
                                        </div>
                                        <p class="step-tip">üí° Make sure the link is set to "Anyone with link can view"</p>
                                    </div>
                                </div>
                                <div class="upload-step active">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <h4>Paste Your Link Below</h4>
                                    </div>
                                </div>
                            </div>

                            <form id="challengeVideoForm">
                                <div class="form-group">
                                    <label>Video Link</label>
                                    <input type="url" id="challengeVideoLink" placeholder="Paste your video link here..." required>
                                </div>
                                <div class="form-group">
                                    <label>What drill is in your video?</label>
                                    <select id="challengeDrillType" required>
                                        <option value="">Select drill type...</option>
                                        <option value="third-shot-drop">üéØ Third Shot Drop</option>
                                        <option value="dinking">üèì Dinking</option>
                                        <option value="serve">üöÄ Serve</option>
                                        <option value="return">‚Ü©Ô∏è Return of Serve</option>
                                        <option value="volley">‚ö° Volley</option>
                                        <option value="reset">üîÑ Reset Shot</option>
                                        <option value="speed-up">üî• Speed-up</option>
                                        <option value="transition">üö∂ Transition Zone</option>
                                    </select>
                                </div>
                                <div class="upload-actions">
                                    <button type="button" class="btn btn-secondary" onclick="hideChallengeUpload()">Cancel</button>
                                    <button type="submit" class="btn btn-primary btn-large">Submit for AI Verification ‚Üí</button>
                                </div>
                            </form>

                            <div class="upload-reassurance">
                                <p>ü§ñ <strong>How it works:</strong> Our AI watches your video to confirm you're doing the drill. Takes about 10 seconds!</p>
                            </div>
                        </div>

                        <!-- Verification Status -->
                        <div class="verification-status" id="verificationStatus" style="display: none;">
                            <div class="verifying" id="verifyingState">
                                <div class="spinner"></div>
                                <p>AI is verifying your video...</p>
                            </div>
                            <div class="verified-success" id="verifiedSuccess" style="display: none;">
                                <span class="success-icon">‚úì</span>
                                <h3>Challenge Completed!</h3>
                                <p>+15 points earned</p>
                            </div>
                            <div class="verified-fail" id="verifiedFail" style="display: none;">
                                <span class="fail-icon">‚úó</span>
                                <h3>Verification Failed</h3>
                                <p id="failReason">The video doesn't match the required drill type.</p>
                                <button class="btn btn-secondary" onclick="retryChallenge()">Try Again</button>
                            </div>
                        </div>

                        <!-- Your Stats -->
                        <div class="challenge-stats">
                            <h3>Your Challenge Stats</h3>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <span class="stat-icon">üî•</span>
                                    <span class="stat-value" id="currentStreak">0</span>
                                    <span class="stat-label">Current Streak</span>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-icon">üèÜ</span>
                                    <span class="stat-value" id="longestStreak">0</span>
                                    <span class="stat-label">Longest Streak</span>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-icon">‚úì</span>
                                    <span class="stat-value" id="totalCompleted">0</span>
                                    <span class="stat-label">Total Completed</span>
                                </div>
                            </div>
                        </div>

                        <!-- NEXT BADGES TO EARN - Simplified View -->
                        <div class="next-badges-section">
                            <div class="next-badges-card">
                                <div class="next-badges-header">
                                    <h3>üéØ Your Next Badges</h3>
                                    <p>Complete these actions to earn your next badges!</p>
                                </div>
                                <div class="next-badges-grid" id="nextBadgesGrid">
                                    <!-- Populated by JS with closest-to-earning badges -->
                                </div>
                                <div class="next-badges-footer">
                                    <button class="btn btn-secondary" id="showAllBadgesBtn">View All 320+ Badges ‚Üí</button>
                                </div>
                            </div>
                        </div>

                        <!-- FULL Badges Collection (Hidden by Default) -->
                        <div class="challenge-badges" id="fullBadgeCollection" style="display: none;">
                            <div class="badges-header">
                                <div class="badges-header-left">
                                    <button class="btn btn-text" id="backToSimpleBadges">‚Üê Back to Next Badges</button>
                                    <h3>üèÖ Full Badge Collection</h3>
                                </div>
                                <div class="badge-progress">
                                    <span id="badgesEarned">0</span> / <span id="badgesTotal">0</span> Badges Earned
                                    <div class="badge-progress-bar">
                                        <div class="badge-progress-fill" id="badgeProgressFill"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Simplified Category Tabs - Grouped -->
                            <div class="badge-categories">
                                <button class="badge-cat-btn active" data-category="all">All Badges</button>
                                <button class="badge-cat-btn" data-category="progress">üìà Progress</button>
                                <button class="badge-cat-btn" data-category="social">üë• Social</button>
                                <button class="badge-cat-btn" data-category="skills">üéØ Skills</button>
                                <button class="badge-cat-btn" data-category="special">‚≠ê Special</button>
                            </div>

                            <!-- Category Legend -->
                            <div class="badge-category-legend">
                                <span class="legend-item"><strong>üìà Progress:</strong> Streaks, Challenges, Contests, Points, Time</span>
                                <span class="legend-item"><strong>üë• Social:</strong> Referrals, Votes, Reactions, Partners, Helper</span>
                                <span class="legend-item"><strong>üéØ Skills:</strong> Drills, DUPR Level, Featured Videos</span>
                                <span class="legend-item"><strong>‚≠ê Special:</strong> Combos, Member #, Seasonal, Secret</span>
                            </div>

                            <div class="badges-grid" id="badgesGrid">
                                <!-- Badges loaded dynamically from API -->
                                <div class="loading" id="badgesLoading">Loading badges...</div>

                                <!-- LEGACY STATIC BADGES (kept as fallback, hidden when API loads)
                                ========== STREAK BADGES (30 badges) ========== -->
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="1">
                                    <span class="badge-icon">üå±</span>
                                    <span class="badge-name">First Step</span>
                                    <span class="badge-desc">1 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="2">
                                    <span class="badge-icon">üåø</span>
                                    <span class="badge-name">Growing Strong</span>
                                    <span class="badge-desc">2 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="3">
                                    <span class="badge-icon">üå≥</span>
                                    <span class="badge-name">Taking Root</span>
                                    <span class="badge-desc">3 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="4">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">On Fire</span>
                                    <span class="badge-desc">4 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="5">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Flame Keeper</span>
                                    <span class="badge-desc">5 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="6">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Lightning</span>
                                    <span class="badge-desc">6 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="7">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Star Power</span>
                                    <span class="badge-desc">7 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="8">
                                    <span class="badge-icon">üíé</span>
                                    <span class="badge-name">Diamond Streak</span>
                                    <span class="badge-desc">8 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="10">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Rocket</span>
                                    <span class="badge-desc">10 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="12">
                                    <span class="badge-icon">üí™</span>
                                    <span class="badge-name">3-Month Warrior</span>
                                    <span class="badge-desc">12 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="16">
                                    <span class="badge-icon">ü¶Å</span>
                                    <span class="badge-name">Lion Heart</span>
                                    <span class="badge-desc">16 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="20">
                                    <span class="badge-icon">üêâ</span>
                                    <span class="badge-name">Dragon Mode</span>
                                    <span class="badge-desc">20 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="26">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">Half-Year Hero</span>
                                    <span class="badge-desc">26 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="30">
                                    <span class="badge-icon">üåä</span>
                                    <span class="badge-name">Tidal Wave</span>
                                    <span class="badge-desc">30 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="36">
                                    <span class="badge-icon">üèîÔ∏è</span>
                                    <span class="badge-name">Mountain Peak</span>
                                    <span class="badge-desc">36 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="40">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Soaring Eagle</span>
                                    <span class="badge-desc">40 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="45">
                                    <span class="badge-icon">üåã</span>
                                    <span class="badge-name">Volcanic</span>
                                    <span class="badge-desc">45 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="50">
                                    <span class="badge-icon">‚öîÔ∏è</span>
                                    <span class="badge-name">Unstoppable</span>
                                    <span class="badge-desc">50 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="52">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Year-Long Legend</span>
                                    <span class="badge-desc">52 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="75">
                                    <span class="badge-icon">üå†</span>
                                    <span class="badge-name">Cosmic Dedication</span>
                                    <span class="badge-desc">75 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="100">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Century Club</span>
                                    <span class="badge-desc">100 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="104">
                                    <span class="badge-icon">üëº</span>
                                    <span class="badge-name">Two-Year Titan</span>
                                    <span class="badge-desc">104 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="150">
                                    <span class="badge-icon">üîÆ</span>
                                    <span class="badge-name">Mystical Master</span>
                                    <span class="badge-desc">150 week streak</span>
                                </div>
                                <div class="badge locked" data-category="streak" data-type="streak" data-requirement="156">
                                    <span class="badge-icon">üé≠</span>
                                    <span class="badge-name">Three-Year Legend</span>
                                    <span class="badge-desc">156 week streak</span>
                                </div>

                                <!-- ========== CHALLENGE COMPLETION BADGES (35 badges) ========== -->
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="1">
                                    <span class="badge-icon">‚úÖ</span>
                                    <span class="badge-name">First Challenge</span>
                                    <span class="badge-desc">Complete 1 challenge</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="3">
                                    <span class="badge-icon">üìã</span>
                                    <span class="badge-name">Getting Started</span>
                                    <span class="badge-desc">Complete 3 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="5">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">High Five</span>
                                    <span class="badge-desc">Complete 5 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="10">
                                    <span class="badge-icon">üîü</span>
                                    <span class="badge-name">Perfect Ten</span>
                                    <span class="badge-desc">Complete 10 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="15">
                                    <span class="badge-icon">üéÆ</span>
                                    <span class="badge-name">Game On</span>
                                    <span class="badge-desc">Complete 15 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="20">
                                    <span class="badge-icon">ü•≥</span>
                                    <span class="badge-name">Score Twenty</span>
                                    <span class="badge-desc">Complete 20 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="25">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">Quarter Century</span>
                                    <span class="badge-desc">Complete 25 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="30">
                                    <span class="badge-icon">üé≤</span>
                                    <span class="badge-name">Thirty Strong</span>
                                    <span class="badge-desc">Complete 30 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="40">
                                    <span class="badge-icon">üé±</span>
                                    <span class="badge-name">Forty Niner</span>
                                    <span class="badge-desc">Complete 40 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="50">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Half Century</span>
                                    <span class="badge-desc">Complete 50 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="60">
                                    <span class="badge-icon">üé™</span>
                                    <span class="badge-name">Sixty Sensation</span>
                                    <span class="badge-desc">Complete 60 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="75">
                                    <span class="badge-icon">üíé</span>
                                    <span class="badge-name">Diamond Challenger</span>
                                    <span class="badge-desc">Complete 75 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="100">
                                    <span class="badge-icon">üíØ</span>
                                    <span class="badge-name">Century Slammer</span>
                                    <span class="badge-desc">Complete 100 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="125">
                                    <span class="badge-icon">üé∞</span>
                                    <span class="badge-name">Challenge Addict</span>
                                    <span class="badge-desc">Complete 125 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="150">
                                    <span class="badge-icon">üåà</span>
                                    <span class="badge-name">Rainbow Warrior</span>
                                    <span class="badge-desc">Complete 150 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="175">
                                    <span class="badge-icon">ü¶ã</span>
                                    <span class="badge-name">Metamorphosis</span>
                                    <span class="badge-desc">Complete 175 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="200">
                                    <span class="badge-icon">üèÖ</span>
                                    <span class="badge-name">Double Century</span>
                                    <span class="badge-desc">Complete 200 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="250">
                                    <span class="badge-icon">üéñÔ∏è</span>
                                    <span class="badge-name">Quarter Millennium</span>
                                    <span class="badge-desc">Complete 250 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="300">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">Triple Century</span>
                                    <span class="badge-desc">Complete 300 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="365">
                                    <span class="badge-icon">üìÖ</span>
                                    <span class="badge-name">Daily Dedication</span>
                                    <span class="badge-desc">Complete 365 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="400">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Quad Century</span>
                                    <span class="badge-desc">Complete 400 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="500">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Challenge King</span>
                                    <span class="badge-desc">Complete 500 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="750">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Hall of Fame</span>
                                    <span class="badge-desc">Complete 750 challenges</span>
                                </div>
                                <div class="badge locked" data-category="challenge" data-type="completed" data-requirement="1000">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Grand Master</span>
                                    <span class="badge-desc">Complete 1000 challenges</span>
                                </div>

                                <!-- ========== CONTEST WIN BADGES (35 badges) ========== -->
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="1">
                                    <span class="badge-icon">ü•á</span>
                                    <span class="badge-name">First Win</span>
                                    <span class="badge-desc">Win 1 contest</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="2">
                                    <span class="badge-icon">‚úåÔ∏è</span>
                                    <span class="badge-name">Double Victory</span>
                                    <span class="badge-desc">Win 2 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="3">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Hat Trick</span>
                                    <span class="badge-desc">Win 3 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="5">
                                    <span class="badge-icon">üñêÔ∏è</span>
                                    <span class="badge-name">High Five Champion</span>
                                    <span class="badge-desc">Win 5 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="7">
                                    <span class="badge-icon">üçÄ</span>
                                    <span class="badge-name">Lucky Seven</span>
                                    <span class="badge-desc">Win 7 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="10">
                                    <span class="badge-icon">üîü</span>
                                    <span class="badge-name">Perfect 10</span>
                                    <span class="badge-desc">Win 10 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="15">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">Rising Star</span>
                                    <span class="badge-desc">Win 15 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="20">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Superstar</span>
                                    <span class="badge-desc">Win 20 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="25">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">Quarter Champion</span>
                                    <span class="badge-desc">Win 25 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="30">
                                    <span class="badge-icon">üëä</span>
                                    <span class="badge-name">Thirty Crusher</span>
                                    <span class="badge-desc">Win 30 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="40">
                                    <span class="badge-icon">üí™</span>
                                    <span class="badge-name">Powerhouse</span>
                                    <span class="badge-desc">Win 40 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="50">
                                    <span class="badge-icon">ü•ä</span>
                                    <span class="badge-name">Fifty Fighter</span>
                                    <span class="badge-desc">Win 50 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="75">
                                    <span class="badge-icon">‚öîÔ∏è</span>
                                    <span class="badge-name">Contest Warrior</span>
                                    <span class="badge-desc">Win 75 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="100">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Century Champion</span>
                                    <span class="badge-desc">Win 100 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="150">
                                    <span class="badge-icon">üêâ</span>
                                    <span class="badge-name">Dragon Slayer</span>
                                    <span class="badge-desc">Win 150 contests</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="wins" data-requirement="200">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Contest Legend</span>
                                    <span class="badge-desc">Win 200 contests</span>
                                </div>

                                <!-- Contest Submission Badges -->
                                <div class="badge locked" data-category="contest" data-type="submissions" data-requirement="1">
                                    <span class="badge-icon">üìπ</span>
                                    <span class="badge-name">First Submission</span>
                                    <span class="badge-desc">Submit 1 video</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="submissions" data-requirement="5">
                                    <span class="badge-icon">üé¨</span>
                                    <span class="badge-name">Video Star</span>
                                    <span class="badge-desc">Submit 5 videos</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="submissions" data-requirement="10">
                                    <span class="badge-icon">üé•</span>
                                    <span class="badge-name">Content Creator</span>
                                    <span class="badge-desc">Submit 10 videos</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="submissions" data-requirement="25">
                                    <span class="badge-icon">üìΩÔ∏è</span>
                                    <span class="badge-name">Film Director</span>
                                    <span class="badge-desc">Submit 25 videos</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="submissions" data-requirement="50">
                                    <span class="badge-icon">üéûÔ∏è</span>
                                    <span class="badge-name">Hollywood Star</span>
                                    <span class="badge-desc">Submit 50 videos</span>
                                </div>
                                <div class="badge locked" data-category="contest" data-type="submissions" data-requirement="100">
                                    <span class="badge-icon">üé¶</span>
                                    <span class="badge-name">Video Legend</span>
                                    <span class="badge-desc">Submit 100 videos</span>
                                </div>

                                <!-- ========== POINTS MILESTONE BADGES (40 badges) ========== -->
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="50">
                                    <span class="badge-icon">ü™ô</span>
                                    <span class="badge-name">First Coins</span>
                                    <span class="badge-desc">Earn 50 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="100">
                                    <span class="badge-icon">üí∞</span>
                                    <span class="badge-name">Century Points</span>
                                    <span class="badge-desc">Earn 100 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="250">
                                    <span class="badge-icon">üíµ</span>
                                    <span class="badge-name">Point Collector</span>
                                    <span class="badge-desc">Earn 250 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="500">
                                    <span class="badge-icon">üíé</span>
                                    <span class="badge-name">Half Grand</span>
                                    <span class="badge-desc">Earn 500 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="750">
                                    <span class="badge-icon">üìà</span>
                                    <span class="badge-name">Rising Earner</span>
                                    <span class="badge-desc">Earn 750 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="1000">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">1K Club</span>
                                    <span class="badge-desc">Earn 1,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="1500">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">Point Star</span>
                                    <span class="badge-desc">Earn 1,500 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="2000">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">2K Achiever</span>
                                    <span class="badge-desc">Earn 2,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="2500">
                                    <span class="badge-icon">‚ú®</span>
                                    <span class="badge-name">Quarter Master</span>
                                    <span class="badge-desc">Earn 2,500 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="3000">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">3K Blazer</span>
                                    <span class="badge-desc">Earn 3,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="4000">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">4K Thunder</span>
                                    <span class="badge-desc">Earn 4,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="5000">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">5K Royalty</span>
                                    <span class="badge-desc">Earn 5,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="7500">
                                    <span class="badge-icon">ü¶Å</span>
                                    <span class="badge-name">Point Lion</span>
                                    <span class="badge-desc">Earn 7,500 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="10000">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">10K Emperor</span>
                                    <span class="badge-desc">Earn 10,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="15000">
                                    <span class="badge-icon">üêâ</span>
                                    <span class="badge-name">15K Dragon</span>
                                    <span class="badge-desc">Earn 15,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="20000">
                                    <span class="badge-icon">üåã</span>
                                    <span class="badge-name">20K Volcanic</span>
                                    <span class="badge-desc">Earn 20,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="25000">
                                    <span class="badge-icon">üéñÔ∏è</span>
                                    <span class="badge-name">25K General</span>
                                    <span class="badge-desc">Earn 25,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="50000">
                                    <span class="badge-icon">üèÖ</span>
                                    <span class="badge-name">50K Legend</span>
                                    <span class="badge-desc">Earn 50,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="points" data-requirement="100000">
                                    <span class="badge-icon">üíé</span>
                                    <span class="badge-name">100K Immortal</span>
                                    <span class="badge-desc">Earn 100,000 points</span>
                                </div>

                                <!-- Points Spending Badges -->
                                <div class="badge locked" data-category="points" data-type="spent" data-requirement="100">
                                    <span class="badge-icon">üõí</span>
                                    <span class="badge-name">First Purchase</span>
                                    <span class="badge-desc">Spend 100 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="spent" data-requirement="500">
                                    <span class="badge-icon">üõçÔ∏è</span>
                                    <span class="badge-name">Shopper</span>
                                    <span class="badge-desc">Spend 500 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="spent" data-requirement="1000">
                                    <span class="badge-icon">üéÅ</span>
                                    <span class="badge-name">Big Spender</span>
                                    <span class="badge-desc">Spend 1,000 points</span>
                                </div>
                                <div class="badge locked" data-category="points" data-type="spent" data-requirement="5000">
                                    <span class="badge-icon">üí∏</span>
                                    <span class="badge-name">Point Mogul</span>
                                    <span class="badge-desc">Spend 5,000 points</span>
                                </div>

                                <!-- ========== SOCIAL/COMMUNITY BADGES (45 badges) ========== -->
                                <!-- Referral Badges -->
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="1">
                                    <span class="badge-icon">ü§ù</span>
                                    <span class="badge-name">First Referral</span>
                                    <span class="badge-desc">Refer 1 friend</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="3">
                                    <span class="badge-icon">üë•</span>
                                    <span class="badge-name">Friend Maker</span>
                                    <span class="badge-desc">Refer 3 friends</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="5">
                                    <span class="badge-icon">üéâ</span>
                                    <span class="badge-name">Party Starter</span>
                                    <span class="badge-desc">Refer 5 friends</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="10">
                                    <span class="badge-icon">üåê</span>
                                    <span class="badge-name">Network Builder</span>
                                    <span class="badge-desc">Refer 10 friends</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="25">
                                    <span class="badge-icon">üèòÔ∏è</span>
                                    <span class="badge-name">Community Builder</span>
                                    <span class="badge-desc">Refer 25 friends</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="50">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Ambassador</span>
                                    <span class="badge-desc">Refer 50 friends</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="referrals" data-requirement="100">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Referral King</span>
                                    <span class="badge-desc">Refer 100 friends</span>
                                </div>

                                <!-- Voting Badges -->
                                <div class="badge locked" data-category="social" data-type="votes" data-requirement="1">
                                    <span class="badge-icon">üó≥Ô∏è</span>
                                    <span class="badge-name">First Vote</span>
                                    <span class="badge-desc">Vote in 1 contest</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="votes" data-requirement="5">
                                    <span class="badge-icon">‚úã</span>
                                    <span class="badge-name">Active Voter</span>
                                    <span class="badge-desc">Vote in 5 contests</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="votes" data-requirement="10">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dedicated Voter</span>
                                    <span class="badge-desc">Vote in 10 contests</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="votes" data-requirement="25">
                                    <span class="badge-icon">üìä</span>
                                    <span class="badge-name">Poll Expert</span>
                                    <span class="badge-desc">Vote in 25 contests</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="votes" data-requirement="50">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">Vote Champion</span>
                                    <span class="badge-desc">Vote in 50 contests</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="votes" data-requirement="100">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Vote Legend</span>
                                    <span class="badge-desc">Vote in 100 contests</span>
                                </div>

                                <!-- Reaction Badges -->
                                <div class="badge locked" data-category="social" data-type="reactions" data-requirement="1">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">First Reaction</span>
                                    <span class="badge-desc">Give 1 reaction</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactions" data-requirement="10">
                                    <span class="badge-icon">üòç</span>
                                    <span class="badge-name">Reactor</span>
                                    <span class="badge-desc">Give 10 reactions</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactions" data-requirement="50">
                                    <span class="badge-icon">üé≠</span>
                                    <span class="badge-name">Emoji Master</span>
                                    <span class="badge-desc">Give 50 reactions</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactions" data-requirement="100">
                                    <span class="badge-icon">üåà</span>
                                    <span class="badge-name">Reaction Pro</span>
                                    <span class="badge-desc">Give 100 reactions</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactions" data-requirement="500">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Reaction Storm</span>
                                    <span class="badge-desc">Give 500 reactions</span>
                                </div>

                                <!-- Received Reactions Badges -->
                                <div class="badge locked" data-category="social" data-type="reactionsReceived" data-requirement="10">
                                    <span class="badge-icon">‚ù§Ô∏è</span>
                                    <span class="badge-name">Loved</span>
                                    <span class="badge-desc">Receive 10 reactions</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactionsReceived" data-requirement="50">
                                    <span class="badge-icon">üíï</span>
                                    <span class="badge-name">Fan Favorite</span>
                                    <span class="badge-desc">Receive 50 reactions</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactionsReceived" data-requirement="100">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Community Star</span>
                                    <span class="badge-desc">Receive 100 reactions</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="reactionsReceived" data-requirement="500">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Reaction Royalty</span>
                                    <span class="badge-desc">Receive 500 reactions</span>
                                </div>

                                <!-- Poll Participation Badges -->
                                <div class="badge locked" data-category="social" data-type="polls" data-requirement="1">
                                    <span class="badge-icon">üìã</span>
                                    <span class="badge-name">Poll Participant</span>
                                    <span class="badge-desc">Vote in 1 poll</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="polls" data-requirement="10">
                                    <span class="badge-icon">üìä</span>
                                    <span class="badge-name">Poll Regular</span>
                                    <span class="badge-desc">Vote in 10 polls</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="polls" data-requirement="25">
                                    <span class="badge-icon">üó≥Ô∏è</span>
                                    <span class="badge-name">Poll Enthusiast</span>
                                    <span class="badge-desc">Vote in 25 polls</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="polls" data-requirement="50">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Poll Master</span>
                                    <span class="badge-desc">Vote in 50 polls</span>
                                </div>

                                <!-- Partner Finding Badges -->
                                <div class="badge locked" data-category="social" data-type="partners" data-requirement="1">
                                    <span class="badge-icon">üéæ</span>
                                    <span class="badge-name">First Partner</span>
                                    <span class="badge-desc">Connect with 1 partner</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="partners" data-requirement="5">
                                    <span class="badge-icon">üë´</span>
                                    <span class="badge-name">Social Player</span>
                                    <span class="badge-desc">Connect with 5 partners</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="partners" data-requirement="10">
                                    <span class="badge-icon">ü§ù</span>
                                    <span class="badge-name">Network Pro</span>
                                    <span class="badge-desc">Connect with 10 partners</span>
                                </div>
                                <div class="badge locked" data-category="social" data-type="partners" data-requirement="25">
                                    <span class="badge-icon">üåê</span>
                                    <span class="badge-name">Connection Master</span>
                                    <span class="badge-desc">Connect with 25 partners</span>
                                </div>

                                <!-- ========== DRILL TYPE BADGES (60 badges) ========== -->
                                <!-- Dinking Drill Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-dinking" data-requirement="1">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dink Beginner</span>
                                    <span class="badge-desc">Complete 1 dink drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-dinking" data-requirement="5">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dink Apprentice</span>
                                    <span class="badge-desc">Complete 5 dink drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-dinking" data-requirement="10">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dink Specialist</span>
                                    <span class="badge-desc">Complete 10 dink drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-dinking" data-requirement="25">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dink Expert</span>
                                    <span class="badge-desc">Complete 25 dink drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-dinking" data-requirement="50">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dink Master</span>
                                    <span class="badge-desc">Complete 50 dink drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-dinking" data-requirement="100">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Dink Legend</span>
                                    <span class="badge-desc">Complete 100 dink drills</span>
                                </div>

                                <!-- Third Shot Drop Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-thirdshot" data-requirement="1">
                                    <span class="badge-icon">ü™Ç</span>
                                    <span class="badge-name">Drop Beginner</span>
                                    <span class="badge-desc">Complete 1 drop drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-thirdshot" data-requirement="5">
                                    <span class="badge-icon">ü™Ç</span>
                                    <span class="badge-name">Drop Apprentice</span>
                                    <span class="badge-desc">Complete 5 drop drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-thirdshot" data-requirement="10">
                                    <span class="badge-icon">ü™Ç</span>
                                    <span class="badge-name">Drop Specialist</span>
                                    <span class="badge-desc">Complete 10 drop drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-thirdshot" data-requirement="25">
                                    <span class="badge-icon">ü™Ç</span>
                                    <span class="badge-name">Drop Expert</span>
                                    <span class="badge-desc">Complete 25 drop drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-thirdshot" data-requirement="50">
                                    <span class="badge-icon">ü™Ç</span>
                                    <span class="badge-name">Drop Master</span>
                                    <span class="badge-desc">Complete 50 drop drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-thirdshot" data-requirement="100">
                                    <span class="badge-icon">ü™Ç</span>
                                    <span class="badge-name">Drop Legend</span>
                                    <span class="badge-desc">Complete 100 drop drills</span>
                                </div>

                                <!-- Serve Drill Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-serve" data-requirement="1">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Serve Beginner</span>
                                    <span class="badge-desc">Complete 1 serve drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-serve" data-requirement="5">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Serve Apprentice</span>
                                    <span class="badge-desc">Complete 5 serve drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-serve" data-requirement="10">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Serve Specialist</span>
                                    <span class="badge-desc">Complete 10 serve drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-serve" data-requirement="25">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Serve Expert</span>
                                    <span class="badge-desc">Complete 25 serve drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-serve" data-requirement="50">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Serve Master</span>
                                    <span class="badge-desc">Complete 50 serve drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-serve" data-requirement="100">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Serve Legend</span>
                                    <span class="badge-desc">Complete 100 serve drills</span>
                                </div>

                                <!-- Volley Drill Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-volley" data-requirement="1">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Volley Beginner</span>
                                    <span class="badge-desc">Complete 1 volley drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-volley" data-requirement="5">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Volley Apprentice</span>
                                    <span class="badge-desc">Complete 5 volley drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-volley" data-requirement="10">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Volley Specialist</span>
                                    <span class="badge-desc">Complete 10 volley drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-volley" data-requirement="25">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Volley Expert</span>
                                    <span class="badge-desc">Complete 25 volley drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-volley" data-requirement="50">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Volley Master</span>
                                    <span class="badge-desc">Complete 50 volley drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-volley" data-requirement="100">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Volley Legend</span>
                                    <span class="badge-desc">Complete 100 volley drills</span>
                                </div>

                                <!-- Footwork Drill Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-footwork" data-requirement="1">
                                    <span class="badge-icon">üëü</span>
                                    <span class="badge-name">Footwork Beginner</span>
                                    <span class="badge-desc">Complete 1 footwork drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-footwork" data-requirement="5">
                                    <span class="badge-icon">üëü</span>
                                    <span class="badge-name">Footwork Apprentice</span>
                                    <span class="badge-desc">Complete 5 footwork drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-footwork" data-requirement="10">
                                    <span class="badge-icon">üëü</span>
                                    <span class="badge-name">Footwork Specialist</span>
                                    <span class="badge-desc">Complete 10 footwork drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-footwork" data-requirement="25">
                                    <span class="badge-icon">üëü</span>
                                    <span class="badge-name">Footwork Expert</span>
                                    <span class="badge-desc">Complete 25 footwork drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-footwork" data-requirement="50">
                                    <span class="badge-icon">üëü</span>
                                    <span class="badge-name">Footwork Master</span>
                                    <span class="badge-desc">Complete 50 footwork drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-footwork" data-requirement="100">
                                    <span class="badge-icon">üëü</span>
                                    <span class="badge-name">Footwork Legend</span>
                                    <span class="badge-desc">Complete 100 footwork drills</span>
                                </div>

                                <!-- Lob Drill Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-lob" data-requirement="1">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Lob Beginner</span>
                                    <span class="badge-desc">Complete 1 lob drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-lob" data-requirement="5">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Lob Apprentice</span>
                                    <span class="badge-desc">Complete 5 lob drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-lob" data-requirement="10">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Lob Specialist</span>
                                    <span class="badge-desc">Complete 10 lob drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-lob" data-requirement="25">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Lob Expert</span>
                                    <span class="badge-desc">Complete 25 lob drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-lob" data-requirement="50">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Lob Master</span>
                                    <span class="badge-desc">Complete 50 lob drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-lob" data-requirement="100">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Lob Legend</span>
                                    <span class="badge-desc">Complete 100 lob drills</span>
                                </div>

                                <!-- Reset Shot Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-reset" data-requirement="1">
                                    <span class="badge-icon">üîÑ</span>
                                    <span class="badge-name">Reset Beginner</span>
                                    <span class="badge-desc">Complete 1 reset drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-reset" data-requirement="5">
                                    <span class="badge-icon">üîÑ</span>
                                    <span class="badge-name">Reset Apprentice</span>
                                    <span class="badge-desc">Complete 5 reset drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-reset" data-requirement="10">
                                    <span class="badge-icon">üîÑ</span>
                                    <span class="badge-name">Reset Specialist</span>
                                    <span class="badge-desc">Complete 10 reset drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-reset" data-requirement="25">
                                    <span class="badge-icon">üîÑ</span>
                                    <span class="badge-name">Reset Expert</span>
                                    <span class="badge-desc">Complete 25 reset drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-reset" data-requirement="50">
                                    <span class="badge-icon">üîÑ</span>
                                    <span class="badge-name">Reset Master</span>
                                    <span class="badge-desc">Complete 50 reset drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-reset" data-requirement="100">
                                    <span class="badge-icon">üîÑ</span>
                                    <span class="badge-name">Reset Legend</span>
                                    <span class="badge-desc">Complete 100 reset drills</span>
                                </div>

                                <!-- ATP (Around The Post) Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-atp" data-requirement="1">
                                    <span class="badge-icon">üåÄ</span>
                                    <span class="badge-name">ATP Beginner</span>
                                    <span class="badge-desc">Complete 1 ATP drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-atp" data-requirement="5">
                                    <span class="badge-icon">üåÄ</span>
                                    <span class="badge-name">ATP Apprentice</span>
                                    <span class="badge-desc">Complete 5 ATP drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-atp" data-requirement="10">
                                    <span class="badge-icon">üåÄ</span>
                                    <span class="badge-name">ATP Specialist</span>
                                    <span class="badge-desc">Complete 10 ATP drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-atp" data-requirement="25">
                                    <span class="badge-icon">üåÄ</span>
                                    <span class="badge-name">ATP Expert</span>
                                    <span class="badge-desc">Complete 25 ATP drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-atp" data-requirement="50">
                                    <span class="badge-icon">üåÄ</span>
                                    <span class="badge-name">ATP Master</span>
                                    <span class="badge-desc">Complete 50 ATP drills</span>
                                </div>

                                <!-- Erne Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-erne" data-requirement="1">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Erne Beginner</span>
                                    <span class="badge-desc">Complete 1 Erne drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-erne" data-requirement="5">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Erne Apprentice</span>
                                    <span class="badge-desc">Complete 5 Erne drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-erne" data-requirement="10">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Erne Specialist</span>
                                    <span class="badge-desc">Complete 10 Erne drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-erne" data-requirement="25">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Erne Expert</span>
                                    <span class="badge-desc">Complete 25 Erne drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-erne" data-requirement="50">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Erne Master</span>
                                    <span class="badge-desc">Complete 50 Erne drills</span>
                                </div>

                                <!-- Speed-up/Firefight Badges -->
                                <div class="badge locked" data-category="drills" data-type="drill-speedup" data-requirement="1">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Firefight Beginner</span>
                                    <span class="badge-desc">Complete 1 speedup drill</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-speedup" data-requirement="5">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Firefight Apprentice</span>
                                    <span class="badge-desc">Complete 5 speedup drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-speedup" data-requirement="10">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Firefight Specialist</span>
                                    <span class="badge-desc">Complete 10 speedup drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-speedup" data-requirement="25">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Firefight Expert</span>
                                    <span class="badge-desc">Complete 25 speedup drills</span>
                                </div>
                                <div class="badge locked" data-category="drills" data-type="drill-speedup" data-requirement="50">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Firefight Master</span>
                                    <span class="badge-desc">Complete 50 speedup drills</span>
                                </div>

                                <!-- ========== TIME-BASED BADGES (30 badges) ========== -->
                                <!-- Membership Anniversary Badges -->
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="7">
                                    <span class="badge-icon">üìÖ</span>
                                    <span class="badge-name">One Week In</span>
                                    <span class="badge-desc">Member for 1 week</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="14">
                                    <span class="badge-icon">üóìÔ∏è</span>
                                    <span class="badge-name">Two Weeks Strong</span>
                                    <span class="badge-desc">Member for 2 weeks</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="30">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">One Month Member</span>
                                    <span class="badge-desc">Member for 1 month</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="60">
                                    <span class="badge-icon">üåì</span>
                                    <span class="badge-name">Two Month Member</span>
                                    <span class="badge-desc">Member for 2 months</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="90">
                                    <span class="badge-icon">üåó</span>
                                    <span class="badge-name">Quarter Year</span>
                                    <span class="badge-desc">Member for 3 months</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="180">
                                    <span class="badge-icon">üåï</span>
                                    <span class="badge-name">Half Year Hero</span>
                                    <span class="badge-desc">Member for 6 months</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="270">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Nine Month Veteran</span>
                                    <span class="badge-desc">Member for 9 months</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="365">
                                    <span class="badge-icon">üéÇ</span>
                                    <span class="badge-name">One Year Anniversary</span>
                                    <span class="badge-desc">Member for 1 year</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="547">
                                    <span class="badge-icon">‚≠ê</span>
                                    <span class="badge-name">18 Month Star</span>
                                    <span class="badge-desc">Member for 18 months</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="730">
                                    <span class="badge-icon">üéä</span>
                                    <span class="badge-name">Two Year Anniversary</span>
                                    <span class="badge-desc">Member for 2 years</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="1095">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Three Year Legend</span>
                                    <span class="badge-desc">Member for 3 years</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="membership" data-requirement="1825">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Five Year Immortal</span>
                                    <span class="badge-desc">Member for 5 years</span>
                                </div>

                                <!-- Login Streak Badges -->
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="3">
                                    <span class="badge-icon">üåÖ</span>
                                    <span class="badge-name">3-Day Login</span>
                                    <span class="badge-desc">Login 3 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="7">
                                    <span class="badge-icon">üåÑ</span>
                                    <span class="badge-name">Week Warrior</span>
                                    <span class="badge-desc">Login 7 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="14">
                                    <span class="badge-icon">üèÉ</span>
                                    <span class="badge-name">2-Week Runner</span>
                                    <span class="badge-desc">Login 14 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="30">
                                    <span class="badge-icon">üìÜ</span>
                                    <span class="badge-name">Monthly Master</span>
                                    <span class="badge-desc">Login 30 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="60">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">60-Day Dedication</span>
                                    <span class="badge-desc">Login 60 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="90">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">90-Day Blaze</span>
                                    <span class="badge-desc">Login 90 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="180">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">180-Day Lightning</span>
                                    <span class="badge-desc">Login 180 days in a row</span>
                                </div>
                                <div class="badge locked" data-category="time" data-type="logins" data-requirement="365">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">365-Day King</span>
                                    <span class="badge-desc">Login every day for a year</span>
                                </div>

                                <!-- ========== SPECIAL/RARE BADGES (50 badges) ========== -->
                                <!-- Profile Badges -->
                                <div class="badge locked" data-category="special" data-type="profile" data-requirement="1">
                                    <span class="badge-icon">üìù</span>
                                    <span class="badge-name">Profile Started</span>
                                    <span class="badge-desc">Add basic info</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="profile" data-requirement="2">
                                    <span class="badge-icon">üì∑</span>
                                    <span class="badge-name">Picture Perfect</span>
                                    <span class="badge-desc">Add profile photo</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="profile" data-requirement="3">
                                    <span class="badge-icon">‚ú®</span>
                                    <span class="badge-name">Profile Complete</span>
                                    <span class="badge-desc">Fill out entire profile</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="profile" data-requirement="4">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">DUPR Verified</span>
                                    <span class="badge-desc">Add your DUPR rating</span>
                                </div>

                                <!-- Early Adopter / Founder Badges -->
                                <div class="badge locked" data-category="special" data-type="founder" data-requirement="1">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Beta Tester</span>
                                    <span class="badge-desc">Joined during beta</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="founder" data-requirement="2">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Founding Member</span>
                                    <span class="badge-desc">First 100 members</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="founder" data-requirement="3">
                                    <span class="badge-icon">üíé</span>
                                    <span class="badge-name">Diamond Founder</span>
                                    <span class="badge-desc">First 50 members</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="founder" data-requirement="4">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">OG Member</span>
                                    <span class="badge-desc">First 10 members</span>
                                </div>

                                <!-- Perfect Week Badges -->
                                <div class="badge locked" data-category="special" data-type="perfectWeek" data-requirement="1">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Perfect Week</span>
                                    <span class="badge-desc">Challenge + Contest + Vote</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="perfectWeek" data-requirement="4">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Perfect Month</span>
                                    <span class="badge-desc">4 perfect weeks</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="perfectWeek" data-requirement="12">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">Perfect Quarter</span>
                                    <span class="badge-desc">12 perfect weeks</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="perfectWeek" data-requirement="52">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Perfect Year</span>
                                    <span class="badge-desc">52 perfect weeks</span>
                                </div>

                                <!-- Comeback Badges -->
                                <div class="badge locked" data-category="special" data-type="comeback" data-requirement="1">
                                    <span class="badge-icon">üîô</span>
                                    <span class="badge-name">Welcome Back</span>
                                    <span class="badge-desc">Return after 2 weeks</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="comeback" data-requirement="2">
                                    <span class="badge-icon">ü¶Ö</span>
                                    <span class="badge-name">Phoenix Rising</span>
                                    <span class="badge-desc">Return after 1 month</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="comeback" data-requirement="3">
                                    <span class="badge-icon">üåÖ</span>
                                    <span class="badge-name">The Return</span>
                                    <span class="badge-desc">Return after 3 months</span>
                                </div>

                                <!-- Win Streak Badges -->
                                <div class="badge locked" data-category="special" data-type="winStreak" data-requirement="2">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Double Win</span>
                                    <span class="badge-desc">Win 2 contests in a row</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="winStreak" data-requirement="3">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">Triple Threat</span>
                                    <span class="badge-desc">Win 3 contests in a row</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="winStreak" data-requirement="4">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">Quad Dominator</span>
                                    <span class="badge-desc">Win 4 contests in a row</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="winStreak" data-requirement="5">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Unstoppable</span>
                                    <span class="badge-desc">Win 5 contests in a row</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="winStreak" data-requirement="10">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Dynasty</span>
                                    <span class="badge-desc">Win 10 contests in a row</span>
                                </div>

                                <!-- Holiday/Seasonal Badges -->
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="1">
                                    <span class="badge-icon">üéÉ</span>
                                    <span class="badge-name">Halloween Hustler</span>
                                    <span class="badge-desc">Active on Halloween</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="2">
                                    <span class="badge-icon">ü¶É</span>
                                    <span class="badge-name">Thankful Player</span>
                                    <span class="badge-desc">Active on Thanksgiving</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="3">
                                    <span class="badge-icon">üéÑ</span>
                                    <span class="badge-name">Holiday Hero</span>
                                    <span class="badge-desc">Active during holidays</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="4">
                                    <span class="badge-icon">üéÜ</span>
                                    <span class="badge-name">New Year Champion</span>
                                    <span class="badge-desc">Active New Year's Day</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="5">
                                    <span class="badge-icon">üíù</span>
                                    <span class="badge-name">Valentine Victor</span>
                                    <span class="badge-desc">Active Valentine's Day</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="6">
                                    <span class="badge-icon">‚òòÔ∏è</span>
                                    <span class="badge-name">Lucky Charm</span>
                                    <span class="badge-desc">Active St. Patrick's Day</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="7">
                                    <span class="badge-icon">üê∞</span>
                                    <span class="badge-name">Easter Ace</span>
                                    <span class="badge-desc">Active on Easter</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="8">
                                    <span class="badge-icon">üá∫üá∏</span>
                                    <span class="badge-name">Independence Star</span>
                                    <span class="badge-desc">Active July 4th</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="9">
                                    <span class="badge-icon">‚òÄÔ∏è</span>
                                    <span class="badge-name">Summer Slammer</span>
                                    <span class="badge-desc">Active summer season</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="10">
                                    <span class="badge-icon">üçÇ</span>
                                    <span class="badge-name">Fall Fighter</span>
                                    <span class="badge-desc">Active fall season</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="11">
                                    <span class="badge-icon">‚ùÑÔ∏è</span>
                                    <span class="badge-name">Winter Warrior</span>
                                    <span class="badge-desc">Active winter season</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="seasonal" data-requirement="12">
                                    <span class="badge-icon">üå∏</span>
                                    <span class="badge-name">Spring Sensation</span>
                                    <span class="badge-desc">Active spring season</span>
                                </div>

                                <!-- Night Owl / Early Bird Badges -->
                                <div class="badge locked" data-category="special" data-type="timeOfDay" data-requirement="1">
                                    <span class="badge-icon">üåÖ</span>
                                    <span class="badge-name">Early Bird</span>
                                    <span class="badge-desc">Active before 6 AM</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="timeOfDay" data-requirement="2">
                                    <span class="badge-icon">ü¶â</span>
                                    <span class="badge-name">Night Owl</span>
                                    <span class="badge-desc">Active after midnight</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="timeOfDay" data-requirement="3">
                                    <span class="badge-icon">üåô</span>
                                    <span class="badge-name">Midnight Grinder</span>
                                    <span class="badge-desc">Active 10 nights</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="timeOfDay" data-requirement="4">
                                    <span class="badge-icon">‚òÄÔ∏è</span>
                                    <span class="badge-name">Morning Champion</span>
                                    <span class="badge-desc">Active 10 early mornings</span>
                                </div>

                                <!-- Improvement Badges -->
                                <div class="badge locked" data-category="special" data-type="improvement" data-requirement="1">
                                    <span class="badge-icon">üìà</span>
                                    <span class="badge-name">Rising Star</span>
                                    <span class="badge-desc">DUPR increased 0.1</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="improvement" data-requirement="2">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Level Up</span>
                                    <span class="badge-desc">DUPR increased 0.25</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="improvement" data-requirement="3">
                                    <span class="badge-icon">‚≠ê</span>
                                    <span class="badge-name">Major Breakthrough</span>
                                    <span class="badge-desc">DUPR increased 0.5</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="improvement" data-requirement="4">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">Transformation</span>
                                    <span class="badge-desc">DUPR increased 1.0</span>
                                </div>

                                <!-- Secret/Hidden Badges -->
                                <div class="badge locked" data-category="special" data-type="secret" data-requirement="1">
                                    <span class="badge-icon">üîÆ</span>
                                    <span class="badge-name">???</span>
                                    <span class="badge-desc">Hidden achievement</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="secret" data-requirement="2">
                                    <span class="badge-icon">üé≠</span>
                                    <span class="badge-name">???</span>
                                    <span class="badge-desc">Hidden achievement</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="secret" data-requirement="3">
                                    <span class="badge-icon">üóùÔ∏è</span>
                                    <span class="badge-name">???</span>
                                    <span class="badge-desc">Hidden achievement</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="secret" data-requirement="4">
                                    <span class="badge-icon">üåà</span>
                                    <span class="badge-name">???</span>
                                    <span class="badge-desc">Hidden achievement</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="secret" data-requirement="5">
                                    <span class="badge-icon">üí´</span>
                                    <span class="badge-name">???</span>
                                    <span class="badge-desc">Hidden achievement</span>
                                </div>

                                <!-- ========== LEADERBOARD POSITION BADGES (8 badges) ========== -->
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="50">
                                    <span class="badge-icon">üìä</span>
                                    <span class="badge-name">Top 50</span>
                                    <span class="badge-desc">Reached Top 50</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="25">
                                    <span class="badge-icon">üìà</span>
                                    <span class="badge-name">Top 25</span>
                                    <span class="badge-desc">Reached Top 25</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="10">
                                    <span class="badge-icon">üîü</span>
                                    <span class="badge-name">Top 10</span>
                                    <span class="badge-desc">Reached Top 10</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="5">
                                    <span class="badge-icon">üñêÔ∏è</span>
                                    <span class="badge-name">Top 5</span>
                                    <span class="badge-desc">Reached Top 5</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="3">
                                    <span class="badge-icon">ü•â</span>
                                    <span class="badge-name">Top 3</span>
                                    <span class="badge-desc">Reached Top 3</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="2">
                                    <span class="badge-icon">ü•à</span>
                                    <span class="badge-name">Runner Up</span>
                                    <span class="badge-desc">Reached #2</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboard" data-requirement="1">
                                    <span class="badge-icon">ü•á</span>
                                    <span class="badge-name">#1 Champion</span>
                                    <span class="badge-desc">Reached #1 spot</span>
                                </div>
                                <div class="badge locked" data-category="leaderboard" data-type="leaderboardStreak" data-requirement="2">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Back-to-Back #1</span>
                                    <span class="badge-desc">#1 twice in a row</span>
                                </div>

                                <!-- ========== VIDEO/FEATURED BADGES (8 badges) ========== -->
                                <div class="badge locked" data-category="featured" data-type="featured" data-requirement="1">
                                    <span class="badge-icon">‚≠ê</span>
                                    <span class="badge-name">Featured Video</span>
                                    <span class="badge-desc">Video was featured</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="coachPick" data-requirement="1">
                                    <span class="badge-icon">üéì</span>
                                    <span class="badge-name">Coach's Pick</span>
                                    <span class="badge-desc">Selected by Coach Ray</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="videoOfWeek" data-requirement="1">
                                    <span class="badge-icon">üìπ</span>
                                    <span class="badge-name">Video of the Week</span>
                                    <span class="badge-desc">Weekly top video</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="videoOfMonth" data-requirement="1">
                                    <span class="badge-icon">üé¨</span>
                                    <span class="badge-name">Video of the Month</span>
                                    <span class="badge-desc">Monthly top video</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="viralVideo" data-requirement="1">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Viral Video</span>
                                    <span class="badge-desc">50+ votes on video</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="cinematic" data-requirement="1">
                                    <span class="badge-icon">üé•</span>
                                    <span class="badge-name">Cinematic</span>
                                    <span class="badge-desc">Outstanding video quality</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="trending" data-requirement="1">
                                    <span class="badge-icon">üìà</span>
                                    <span class="badge-name">Trending</span>
                                    <span class="badge-desc">Video went trending</span>
                                </div>
                                <div class="badge locked" data-category="featured" data-type="videoHallOfFame" data-requirement="1">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Video Hall of Fame</span>
                                    <span class="badge-desc">All-time great video</span>
                                </div>

                                <!-- ========== COMMUNITY HELPER BADGES (8 badges) ========== -->
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="1">
                                    <span class="badge-icon">üëã</span>
                                    <span class="badge-name">Welcome Wagon</span>
                                    <span class="badge-desc">Helped 1 new member</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="5">
                                    <span class="badge-icon">ü§ó</span>
                                    <span class="badge-name">Helpful Member</span>
                                    <span class="badge-desc">Helped 5 members</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="10">
                                    <span class="badge-icon">üßë‚Äçüè´</span>
                                    <span class="badge-name">Mentor</span>
                                    <span class="badge-desc">Helped 10 members</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="25">
                                    <span class="badge-icon">üó∫Ô∏è</span>
                                    <span class="badge-name">Community Guide</span>
                                    <span class="badge-desc">Helped 25 members</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="50">
                                    <span class="badge-icon">ü¶∏</span>
                                    <span class="badge-name">Community Leader</span>
                                    <span class="badge-desc">Helped 50 members</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="100">
                                    <span class="badge-icon">üßô</span>
                                    <span class="badge-name">Elder</span>
                                    <span class="badge-desc">Helped 100 members</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="200">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Pillar of Community</span>
                                    <span class="badge-desc">Helped 200 members</span>
                                </div>
                                <div class="badge locked" data-category="helper" data-type="helper" data-requirement="500">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Ambassador Elite</span>
                                    <span class="badge-desc">Helped 500 members</span>
                                </div>

                                <!-- ========== DUPR SKILL LEVEL BADGES (10 badges) ========== -->
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="3.0">
                                    <span class="badge-icon">üéæ</span>
                                    <span class="badge-name">3.0 Club</span>
                                    <span class="badge-desc">DUPR 3.0+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="3.25">
                                    <span class="badge-icon">üìà</span>
                                    <span class="badge-name">3.25 Rising</span>
                                    <span class="badge-desc">DUPR 3.25+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="3.5">
                                    <span class="badge-icon">‚≠ê</span>
                                    <span class="badge-name">3.5 Achiever</span>
                                    <span class="badge-desc">DUPR 3.5+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="3.75">
                                    <span class="badge-icon">üèÖ</span>
                                    <span class="badge-name">3.75 Competitor</span>
                                    <span class="badge-desc">DUPR 3.75+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="4.0">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">4.0 Elite</span>
                                    <span class="badge-desc">DUPR 4.0+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="4.25">
                                    <span class="badge-icon">üí™</span>
                                    <span class="badge-name">4.25 Advanced</span>
                                    <span class="badge-desc">DUPR 4.25+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="4.5">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">4.5 Expert</span>
                                    <span class="badge-desc">DUPR 4.5+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="4.75">
                                    <span class="badge-icon">‚ö°</span>
                                    <span class="badge-name">4.75 Pro</span>
                                    <span class="badge-desc">DUPR 4.75+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="5.0">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">5.0 Master</span>
                                    <span class="badge-desc">DUPR 5.0+</span>
                                </div>
                                <div class="badge locked" data-category="skill" data-type="dupr" data-requirement="5.5">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">5.5+ Legend</span>
                                    <span class="badge-desc">DUPR 5.5+</span>
                                </div>

                                <!-- ========== COMBO/MULTI-CATEGORY BADGES (10 badges) ========== -->
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="1">
                                    <span class="badge-icon">‚úåÔ∏è</span>
                                    <span class="badge-name">Daily Double</span>
                                    <span class="badge-desc">Challenge + Contest same day</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="2">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Triple Threat</span>
                                    <span class="badge-desc">Challenge + Contest + Vote</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="3">
                                    <span class="badge-icon">üí•</span>
                                    <span class="badge-name">Quad Force</span>
                                    <span class="badge-desc">All 4 activities in one week</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="4">
                                    <span class="badge-icon">ü¶ã</span>
                                    <span class="badge-name">Social Butterfly</span>
                                    <span class="badge-desc">5 reactions + vote + poll</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="5">
                                    <span class="badge-icon">‚öôÔ∏è</span>
                                    <span class="badge-name">Grinder</span>
                                    <span class="badge-desc">3 challenges in one week</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="6">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-name">Streak + Win</span>
                                    <span class="badge-desc">Win while on streak</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="7">
                                    <span class="badge-icon">ü§ù</span>
                                    <span class="badge-name">Referral + Win</span>
                                    <span class="badge-desc">Refer friend & win same week</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="8">
                                    <span class="badge-icon">üåç</span>
                                    <span class="badge-name">All-Rounder</span>
                                    <span class="badge-desc">1 of everything in a month</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="9">
                                    <span class="badge-icon">üíé</span>
                                    <span class="badge-name">Perfectionist</span>
                                    <span class="badge-desc">Perfect participation monthly</span>
                                </div>
                                <div class="badge locked" data-category="combo" data-type="combo" data-requirement="10">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Ultimate Achiever</span>
                                    <span class="badge-desc">All combos unlocked</span>
                                </div>

                                <!-- ========== MEMBER NUMBER BADGES (8 badges) ========== -->
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="10">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">The Originals</span>
                                    <span class="badge-desc">Member #1-10</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="50">
                                    <span class="badge-icon">üöÄ</span>
                                    <span class="badge-name">Early Adopter</span>
                                    <span class="badge-desc">Member #11-50</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="100">
                                    <span class="badge-icon">üíØ</span>
                                    <span class="badge-name">Century Club</span>
                                    <span class="badge-desc">Member #51-100</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="250">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Quarter Thousand</span>
                                    <span class="badge-desc">Member #101-250</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="500">
                                    <span class="badge-icon">üèÖ</span>
                                    <span class="badge-name">Half Thousand</span>
                                    <span class="badge-desc">Member #251-500</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="1000">
                                    <span class="badge-icon">üéÜ</span>
                                    <span class="badge-name">Millennium Member</span>
                                    <span class="badge-desc">Member #501-1000</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="5000">
                                    <span class="badge-icon">üåç</span>
                                    <span class="badge-name">5K Era</span>
                                    <span class="badge-desc">Member #1001-5000</span>
                                </div>
                                <div class="badge locked" data-category="member" data-type="memberNumber" data-requirement="10000">
                                    <span class="badge-icon">üåê</span>
                                    <span class="badge-name">Growth Era</span>
                                    <span class="badge-desc">Member #5001+</span>
                                </div>

                                <!-- ========== TIP OF THE WEEK BADGES (6 badges) ========== -->
                                <div class="badge locked" data-category="special" data-type="tips" data-requirement="1">
                                    <span class="badge-icon">üí°</span>
                                    <span class="badge-name">Tip Submitter</span>
                                    <span class="badge-desc">Submitted 1 tip</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="tips" data-requirement="5">
                                    <span class="badge-icon">üìù</span>
                                    <span class="badge-name">Tip Regular</span>
                                    <span class="badge-desc">Submitted 5 tips</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="featuredTip" data-requirement="1">
                                    <span class="badge-icon">‚≠ê</span>
                                    <span class="badge-name">Featured Tip</span>
                                    <span class="badge-desc">Tip was featured</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="featuredTip" data-requirement="10">
                                    <span class="badge-icon">üéØ</span>
                                    <span class="badge-name">Tip Master</span>
                                    <span class="badge-desc">10 featured tips</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="featuredTip" data-requirement="25">
                                    <span class="badge-icon">üèÜ</span>
                                    <span class="badge-name">Tip Legend</span>
                                    <span class="badge-desc">25 featured tips</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="tipHallOfFame" data-requirement="1">
                                    <span class="badge-icon">üèõÔ∏è</span>
                                    <span class="badge-name">Tip Hall of Fame</span>
                                    <span class="badge-desc">All-time great tips</span>
                                </div>

                                <!-- ========== SHOUTOUT/WALL OF FAME BADGES (6 badges) ========== -->
                                <div class="badge locked" data-category="special" data-type="shoutouts" data-requirement="1">
                                    <span class="badge-icon">üì¢</span>
                                    <span class="badge-name">First Shoutout</span>
                                    <span class="badge-desc">Received 1 shoutout</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="shoutouts" data-requirement="5">
                                    <span class="badge-icon">üé§</span>
                                    <span class="badge-name">Shoutout Regular</span>
                                    <span class="badge-desc">Received 5 shoutouts</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="shoutouts" data-requirement="10">
                                    <span class="badge-icon">üåü</span>
                                    <span class="badge-name">Shoutout Star</span>
                                    <span class="badge-desc">Received 10 shoutouts</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="wallOfFame" data-requirement="1">
                                    <span class="badge-icon">üñºÔ∏è</span>
                                    <span class="badge-name">Wall of Fame</span>
                                    <span class="badge-desc">Inducted to Wall of Fame</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="shoutouts" data-requirement="25">
                                    <span class="badge-icon">üé≠</span>
                                    <span class="badge-name">Community Celebrity</span>
                                    <span class="badge-desc">Received 25 shoutouts</span>
                                </div>
                                <div class="badge locked" data-category="special" data-type="shoutouts" data-requirement="50">
                                    <span class="badge-icon">üëë</span>
                                    <span class="badge-name">Living Legend</span>
                                    <span class="badge-desc">Received 50 shoutouts</span>
                                </div>

                            </div>
                        </div>

                        <!-- Challenge Leaderboard -->
                        <div class="challenge-leaderboard">
                            <h3>Challenge Leaderboard</h3>
                            <div class="leaderboard-list" id="challengeLeaderboard">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PARTNER FINDER TAB -->
                <div class="tab-content" id="partners-tab">
                    <div class="partners-section">
                        <div class="partners-header">
                            <h2>Find Drill Partners</h2>
                            <p>Connect with other members in your area</p>
                        </div>

                        <!-- Filters -->
                        <div class="partner-filters">
                            <div class="filter-group">
                                <label>Location</label>
                                <input type="text" id="filterLocation" placeholder="City or state...">
                            </div>
                            <div class="filter-group">
                                <label>Skill Level</label>
                                <select id="filterSkill">
                                    <option value="">Any</option>
                                    <option value="3.0-3.5">3.0 - 3.5</option>
                                    <option value="3.5-4.0">3.5 - 4.0</option>
                                    <option value="4.0-4.5">4.0 - 4.5</option>
                                    <option value="4.5+">4.5+</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" id="searchPartners">Search</button>
                        </div>

                        <!-- Partner Cards -->
                        <div class="partners-grid" id="partnersGrid">
                            <!-- Populated by JS -->
                            <div class="no-partners" id="noPartners">
                                <p>No members found matching your criteria.</p>
                                <p>Try broadening your search or check back later!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- REWARDS TAB -->
                <div class="tab-content" id="rewards-tab">
                    <div class="rewards-section">
                        <div class="rewards-header">
                            <h2>üéÅ Your Rewards</h2>
                            <div class="points-display">
                                <span class="points-value" id="rewardsPoints">0</span>
                                <span class="points-label">Points Available</span>
                            </div>
                        </div>

                        <!-- Quick Points Calculator -->
                        <div class="points-calculator">
                            <h3>üí° Quick Points Guide</h3>
                            <p class="calc-subtitle">Here's how fast you can earn rewards:</p>
                            <div class="calc-examples">
                                <div class="calc-example">
                                    <span class="calc-label">Every Week (Minimum Effort)</span>
                                    <span class="calc-breakdown">Vote (2 pts)</span>
                                    <span class="calc-total">= 2 pts/week</span>
                                </div>
                                <div class="calc-example recommended">
                                    <span class="calc-label">Every Week (Recommended)</span>
                                    <span class="calc-breakdown">Challenge (15) + Vote (2)</span>
                                    <span class="calc-total">= 17 pts/week</span>
                                </div>
                                <div class="calc-example">
                                    <span class="calc-label">Every Week (All In!)</span>
                                    <span class="calc-breakdown">Challenge (15) + Contest (20) + Vote (2)</span>
                                    <span class="calc-total">= 37 pts/week</span>
                                </div>
                            </div>
                            <div class="calc-milestone">
                                <p>üéØ <strong>Your first reward (50 pts)</strong> = Just 3 weeks of challenges!</p>
                            </div>
                        </div>

                        <!-- How to Earn Points - Clearer Layout -->
                        <div class="earn-points">
                            <h3>üìà Ways to Earn Points</h3>

                            <div class="earn-category">
                                <h4>üîÑ Weekly Activities</h4>
                                <div class="earn-grid">
                                    <div class="earn-item">
                                        <span class="earn-icon">üìπ</span>
                                        <div class="earn-details">
                                            <span class="earn-action">Complete Drill Challenge</span>
                                            <span class="earn-desc">Upload video of weekly drill</span>
                                        </div>
                                        <span class="earn-points-value">+15 pts</span>
                                    </div>
                                    <div class="earn-item">
                                        <span class="earn-icon">üé¨</span>
                                        <div class="earn-details">
                                            <span class="earn-action">Submit to Contest</span>
                                            <span class="earn-desc">Enter your best video</span>
                                        </div>
                                        <span class="earn-points-value">+20 pts</span>
                                    </div>
                                    <div class="earn-item">
                                        <span class="earn-icon">üó≥Ô∏è</span>
                                        <div class="earn-details">
                                            <span class="earn-action">Vote in Contest</span>
                                            <span class="earn-desc">Support fellow members</span>
                                        </div>
                                        <span class="earn-points-value">+2 pts</span>
                                    </div>
                                </div>
                            </div>

                            <div class="earn-category">
                                <h4>üèÜ Achievements</h4>
                                <div class="earn-grid">
                                    <div class="earn-item highlight">
                                        <span class="earn-icon">ü•á</span>
                                        <div class="earn-details">
                                            <span class="earn-action">Win a Contest</span>
                                            <span class="earn-desc">Get the most votes!</span>
                                        </div>
                                        <span class="earn-points-value">+50 pts</span>
                                    </div>
                                    <div class="earn-item">
                                        <span class="earn-icon">üî•</span>
                                        <div class="earn-details">
                                            <span class="earn-action">4-Week Streak Bonus</span>
                                            <span class="earn-desc">Complete 4 challenges in a row</span>
                                        </div>
                                        <span class="earn-points-value">+30 pts</span>
                                    </div>
                                </div>
                            </div>

                            <div class="earn-category">
                                <h4>‚≠ê One-Time Bonuses</h4>
                                <div class="earn-grid">
                                    <div class="earn-item">
                                        <span class="earn-icon">üë§</span>
                                        <div class="earn-details">
                                            <span class="earn-action">Complete Profile</span>
                                            <span class="earn-desc">Add photo, DUPR, location</span>
                                        </div>
                                        <span class="earn-points-value">+10 pts</span>
                                    </div>
                                    <div class="earn-item highlight">
                                        <span class="earn-icon">ü§ù</span>
                                        <div class="earn-details">
                                            <span class="earn-action">Refer a Friend</span>
                                            <span class="earn-desc">When they join as a member</span>
                                        </div>
                                        <span class="earn-points-value">+50 pts</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Redeem Rewards -->
                        <div class="redeem-rewards">
                            <h3>Redeem Your Points</h3>
                            <div class="rewards-grid">
                                <div class="reward-card" data-cost="50">
                                    <div class="reward-icon">ü§ñ</div>
                                    <h4>Free AI Drill Analysis</h4>
                                    <p>1 credit for the AI Drill Coach</p>
                                    <div class="reward-cost">50 points</div>
                                    <button class="btn btn-primary redeem-btn" data-reward="drill-credit">Redeem</button>
                                </div>
                                <div class="reward-card" data-cost="100">
                                    <div class="reward-icon">üíµ</div>
                                    <h4>$5 Off Any Purchase</h4>
                                    <p>Discount code for any service</p>
                                    <div class="reward-cost">100 points</div>
                                    <button class="btn btn-primary redeem-btn" data-reward="discount-5">Redeem</button>
                                </div>
                                <div class="reward-card" data-cost="500">
                                    <div class="reward-icon">üìä</div>
                                    <h4>Free 30-Min Video Analysis</h4>
                                    <p>Complete gameplay breakdown</p>
                                    <div class="reward-cost">500 points</div>
                                    <button class="btn btn-primary redeem-btn" data-reward="analysis-30">Redeem</button>
                                </div>
                                <div class="reward-card" data-cost="800">
                                    <div class="reward-icon">üèÜ</div>
                                    <h4>Free 60-Min Video Analysis</h4>
                                    <p>Full in-depth analysis package</p>
                                    <div class="reward-cost">800 points</div>
                                    <button class="btn btn-primary redeem-btn" data-reward="analysis-60">Redeem</button>
                                </div>
                            </div>
                        </div>

                        <!-- Points History -->
                        <div class="points-history">
                            <h3>Recent Activity</h3>
                            <div class="history-list" id="pointsHistory">
                                <p class="no-history">No points activity yet. Complete a challenge to start earning!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PROGRESS TAB -->
                <div class="tab-content" id="progress-tab">
                    <div class="progress-section">
                        <div class="progress-header">
                            <h2>üìà Your Progress</h2>
                            <p>Track your improvement over time</p>
                        </div>

                        <!-- Skill Progression Chart -->
                        <div id="progressChartContainer">
                            <!-- Populated by Social.renderProgressChart() -->
                        </div>

                        <!-- Video Analysis History -->
                        <div class="analysis-history-section">
                            <h3>üìπ Video Analysis History</h3>
                            <div id="analysisHistoryContainer">
                                <p class="no-history">Submit a video for analysis to start tracking your improvement!</p>
                            </div>
                        </div>

                        <!-- Personal Stats -->
                        <div class="personal-stats-section">
                            <h3>üìä Personal Statistics</h3>
                            <div class="personal-stats-grid">
                                <div class="personal-stat-card">
                                    <span class="stat-icon">üé¨</span>
                                    <span class="stat-value" id="totalVideosAnalyzed">0</span>
                                    <span class="stat-label">Videos Analyzed</span>
                                </div>
                                <div class="personal-stat-card">
                                    <span class="stat-icon">üèÉ</span>
                                    <span class="stat-value" id="totalDrillsCompleted">0</span>
                                    <span class="stat-label">Drills Completed</span>
                                </div>
                                <div class="personal-stat-card">
                                    <span class="stat-icon">üî•</span>
                                    <span class="stat-value" id="longestStreakStat">0</span>
                                    <span class="stat-label">Longest Streak</span>
                                </div>
                                <div class="personal-stat-card">
                                    <span class="stat-icon">üìÖ</span>
                                    <span class="stat-value" id="memberSince">--</span>
                                    <span class="stat-label">Member Since</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LEADERBOARD TAB -->
                <div class="tab-content" id="leaderboard-tab">
                    <div class="leaderboard-section">
                        <div class="leaderboard-header">
                            <h2>üèÜ Community Leaderboard</h2>
                            <p>See how you stack up against other members</p>
                        </div>

                        <!-- Leaderboard Component -->
                        <div id="leaderboardContainer">
                            <!-- Populated by Gamification.renderLeaderboard() -->
                        </div>

                        <!-- Your Rank Card -->
                        <div class="your-rank-card" id="yourRankCard">
                            <h4>Your Current Rank</h4>
                            <div class="rank-display">
                                <span class="rank-number" id="yourRank">#--</span>
                                <span class="rank-xp" id="yourTotalXP">0 XP</span>
                            </div>
                            <p class="rank-message" id="rankMessage">Keep earning XP to climb the ranks!</p>
                        </div>

                        <!-- Top Badges Showcase -->
                        <div class="top-badges-section">
                            <h3>üèÖ Rarest Badges Earned</h3>
                            <div id="topBadgesContainer">
                                <!-- Shows members with rare badges -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MEMBER SPOTLIGHT TAB (Hidden - replaced with Leaderboard) -->
                <div class="tab-content" id="spotlight-tab" style="display:none;">
                    <div class="spotlight-section">
                        <div class="spotlight-header">
                            <h2>Member of the Month</h2>
                            <p>Celebrating our most engaged community members</p>
                        </div>

                        <div class="spotlight-card" id="spotlightCard">
                            <div class="spotlight-photo" id="spotlightPhoto">üì∑</div>
                            <div class="spotlight-info">
                                <h3 id="spotlightName">Coming Soon!</h3>
                                <p id="spotlightLocation">--</p>
                                <p id="spotlightAchievement">Our first Member of the Month will be featured here.</p>
                            </div>
                        </div>

                        <div class="past-spotlights">
                            <h3>Past Spotlights</h3>
                            <div class="past-spotlights-grid" id="pastSpotlights">
                                <p class="no-spotlights">No past spotlights yet.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Ray Paull Pickleball Analysis. All rights reserved.</p>
        </div>
    </footer>


    <script>
        // ============================================
        // MEMBER HUB FUNCTIONALITY
        // ============================================

        const DEFAULT_CHALLENGE = {
            title: 'Practice 100 Third Shot Drops',
            description: 'Focus on soft, controlled drops that land in the kitchen. Quality over speed!',
            goal: '100 drops',
            weekEnding: getWeekEnding()
        };

        function getWeekEnding() {
            const now = new Date();
            const saturday = new Date(now);
            saturday.setDate(now.getDate() + (6 - now.getDay() + 7) % 7);
            saturday.setHours(23, 59, 59, 999);
            if (saturday <= now) saturday.setDate(saturday.getDate() + 7);
            return saturday.toISOString();
        }

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab + '-tab').classList.add('active');
            });
        });

        // Login form
        document.getElementById('hubLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('hubLoginEmail').value.trim().toLowerCase();
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.email.toLowerCase() === email && m.active);

            if (member) {
                localStorage.setItem('memberEmail', email);
                loadMemberHub();
            } else {
                alert('Member not found. Check your email or join at membership.html');
            }
        });

        // ============================================
        // PROFILE
        // ============================================
        function loadProfile(member) {
            document.getElementById('profileName').textContent = member.name;
            document.getElementById('profileLocation').textContent = member.profile?.location || 'Location not set';
            document.getElementById('statPoints').textContent = member.points || 0;
            document.getElementById('statDupr').textContent = member.profile?.dupr || '--';
            document.getElementById('statWins').textContent = member.wins || 0;
            document.getElementById('statStreak').textContent = member.challengeStreak || 0;
            document.getElementById('statChallenges').textContent = member.challengesCompleted || 0;

            document.getElementById('profileBio').textContent = member.profile?.bio || 'Add a bio to tell others about yourself!';
            document.getElementById('profileStyle').textContent = member.profile?.style ? `${member.profile.style}${member.profile.position ? ' ‚Ä¢ ' + member.profile.position : ''}` : '--';
            document.getElementById('profileCourts').textContent = member.profile?.courts || '--';
            document.getElementById('profileAvailability').textContent = member.profile?.availability || '--';
            document.getElementById('profileSocial').textContent = member.profile?.social ? member.profile.social : '--';

            // Photo
            const photoEl = document.getElementById('profilePhoto');
            if (member.profile?.photo) {
                photoEl.innerHTML = `<img src="${member.profile.photo}" alt="Profile">`;
            }

            // Badges
            const badgesEl = document.getElementById('profileBadges');
            const badges = [];
            if (member.wins >= 1) badges.push('Contest Winner');
            if (member.challengeStreak >= 4) badges.push('4-Week Streak');
            if (member.plan === 'annual') badges.push('Annual Member');
            badgesEl.innerHTML = badges.map(b => `<span class="profile-badge">${b}</span>`).join('');
        }

        // Edit profile
        document.getElementById('editProfileBtn').addEventListener('click', () => {
            const memberEmail = localStorage.getItem('memberEmail');
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.email.toLowerCase() === memberEmail.toLowerCase());

            if (member) {
                document.getElementById('editName').value = member.name || '';
                document.getElementById('editPhoto').value = member.profile?.photo || '';
                document.getElementById('editLocation').value = member.profile?.location || '';
                document.getElementById('editDupr').value = member.profile?.dupr || '';
                document.getElementById('editStyle').value = member.profile?.style || '';
                document.getElementById('editPosition').value = member.profile?.position || '';
                document.getElementById('editCourts').value = member.profile?.courts || '';
                document.getElementById('editAvailability').value = member.profile?.availability || '';
                document.getElementById('editBio').value = member.profile?.bio || '';
                document.getElementById('editSocial').value = member.profile?.social || '';
            }

            document.getElementById('editProfileModal').classList.add('active');
        });

        function closeEditModal() {
            document.getElementById('editProfileModal').classList.remove('active');
        }

        document.getElementById('editProfileForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const memberEmail = localStorage.getItem('memberEmail');
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const memberIndex = members.findIndex(m => m.email.toLowerCase() === memberEmail.toLowerCase());

            if (memberIndex > -1) {
                // Check if profile was already complete before save
                const wasComplete = checkProfileComplete(members[memberIndex].profile);
                const hadProfileBonus = members[memberIndex].profileBonusAwarded;

                members[memberIndex].name = document.getElementById('editName').value;
                members[memberIndex].profile = {
                    photo: document.getElementById('editPhoto').value,
                    location: document.getElementById('editLocation').value,
                    dupr: document.getElementById('editDupr').value,
                    style: document.getElementById('editStyle').value,
                    position: document.getElementById('editPosition').value,
                    courts: document.getElementById('editCourts').value,
                    availability: document.getElementById('editAvailability').value,
                    bio: document.getElementById('editBio').value,
                    social: document.getElementById('editSocial').value
                };

                // Check if profile is now complete (and wasn't before, and hasn't received bonus)
                const isNowComplete = checkProfileComplete(members[memberIndex].profile);
                if (isNowComplete && !hadProfileBonus) {
                    addPoints(members[memberIndex], POINTS.PROFILE_COMPLETE, 'Completed full profile (one-time bonus)');
                    members[memberIndex].profileBonusAwarded = true;
                    alert('Profile saved! +10 points for completing your profile!');
                }

                localStorage.setItem('members', JSON.stringify(members));
                closeEditModal();
                loadProfile(members[memberIndex]);
                loadRewards(members[memberIndex]);
            }
        });

        // ============================================
        // CHALLENGES
        // ============================================
        function loadChallenges(member) {
            // Load current challenge
            let challenge = JSON.parse(localStorage.getItem('currentDrillChallenge'));
            if (!challenge || new Date(challenge.weekEnding) < new Date()) {
                challenge = DEFAULT_CHALLENGE;
                localStorage.setItem('currentDrillChallenge', JSON.stringify(challenge));
            }

            document.getElementById('challengeTitle').textContent = challenge.title;
            document.getElementById('challengeDescription').textContent = challenge.description;
            document.getElementById('challengeGoal').textContent = challenge.goal;

            // Check if completed this week
            const completedWeek = member.lastChallengeWeek;
            const currentWeek = challenge.weekEnding;
            const showUploadBtn = document.getElementById('showUploadForm');
            const challengeAction = document.getElementById('challengeAction');

            if (completedWeek === currentWeek) {
                if (showUploadBtn) {
                    showUploadBtn.textContent = '‚úì Completed!';
                    showUploadBtn.classList.add('completed');
                    showUploadBtn.disabled = true;
                }
                // Hide upload form if they already completed
                document.getElementById('challengeUploadForm').style.display = 'none';
                document.getElementById('verificationStatus').style.display = 'none';
            }

            // Stats
            document.getElementById('currentStreak').textContent = member.challengeStreak || 0;
            document.getElementById('longestStreak').textContent = member.longestStreak || 0;
            document.getElementById('totalCompleted').textContent = member.challengesCompleted || 0;

            // Load badges from API (dynamic), then update states and setup filters
            loadBadgesFromAPI().then(() => {
                updateAllBadges(member);
                setupBadgeCategoryFilters();
            });

            // Leaderboard
            loadChallengeLeaderboard();
        }

        function loadChallengeLeaderboard() {
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const sorted = members
                .filter(m => m.active && (m.challengeStreak || 0) > 0)
                .sort((a, b) => (b.challengeStreak || 0) - (a.challengeStreak || 0))
                .slice(0, 10);

            const leaderboardEl = document.getElementById('challengeLeaderboard');

            if (sorted.length === 0) {
                leaderboardEl.innerHTML = '<p style="color: var(--text-light); text-align: center;">No streak data yet. Complete a challenge to get on the board!</p>';
                return;
            }

            leaderboardEl.innerHTML = sorted.map((m, i) => `
                <div class="leaderboard-row">
                    <span class="rank">#${i + 1}</span>
                    <span class="name">${m.name}</span>
                    <span class="streak">${m.challengeStreak} week${m.challengeStreak > 1 ? 's' : ''}</span>
                </div>
            `).join('');
        }

        // ============================================
        // COMPREHENSIVE BADGE SYSTEM
        // ============================================
        // Load badges dynamically from API (replaces hardcoded HTML)
        async function loadBadgesFromAPI() {
            const grid = document.getElementById('badgesGrid');
            const loadingEl = document.getElementById('badgesLoading');

            try {
                const response = await fetch(`${CONFIG?.API_BASE_URL || ''}/api-gamification/badges`);
                if (!response.ok) throw new Error('API unavailable');
                const data = await response.json();

                // Flatten grouped badges into ordered array
                const categoryOrder = ['streak','challenge','contest','points','social','drills','time','special',
                                       'leaderboard','featured','helper','skill','combo','member'];
                let badgesHTML = '';
                let count = 0;

                for (const cat of categoryOrder) {
                    const badges = data.badges[cat] || [];
                    if (badges.length === 0) continue;

                    for (const b of badges) {
                        count++;
                        badgesHTML += `<div class="badge locked" data-category="${b.category}" data-type="${b.requirement_action || b.requirement_type}" data-requirement="${b.requirement_value}">
                            <span class="badge-icon">${b.icon}</span>
                            <span class="badge-name">${b.name}</span>
                            <span class="badge-desc">${b.description}</span>
                        </div>`;
                    }
                }

                // Also include any categories not in our ordered list
                for (const [cat, badges] of Object.entries(data.badges)) {
                    if (categoryOrder.includes(cat)) continue;
                    for (const b of badges) {
                        count++;
                        badgesHTML += `<div class="badge locked" data-category="${b.category}" data-type="${b.requirement_action || b.requirement_type}" data-requirement="${b.requirement_value}">
                            <span class="badge-icon">${b.icon}</span>
                            <span class="badge-name">${b.name}</span>
                            <span class="badge-desc">${b.description}</span>
                        </div>`;
                    }
                }

                if (count > 0) {
                    grid.innerHTML = badgesHTML;
                    console.log(`Loaded ${count} badges from API`);
                } else {
                    // No badges in DB, keep the static fallback
                    if (loadingEl) loadingEl.style.display = 'none';
                }
            } catch (err) {
                console.log('Badge API unavailable, using static badges:', err.message);
                if (loadingEl) loadingEl.style.display = 'none';
                // Static badges already in the HTML serve as fallback
            }
        }

        function updateAllBadges(member) {
            // Gather all member stats
            const stats = {
                // Streak stats
                streak: member.longestStreak || 0,
                currentStreak: member.challengeStreak || 0,

                // Challenge stats
                completed: member.challengesCompleted || 0,

                // Contest stats
                wins: member.contestWins || 0,
                submissions: member.contestSubmissions || 0,

                // Points stats
                points: member.pointsEarned || member.points || 0,
                spent: member.pointsSpent || 0,

                // Social stats
                referrals: member.referralCount || 0,
                votes: member.votesCount || 0,
                reactions: member.reactionsGiven || 0,
                reactionsReceived: member.reactionsReceived || 0,
                polls: member.pollsVoted || 0,
                partners: member.partnersConnected || 0,

                // Drill type stats (from challenge history)
                drillTypes: member.drillStats || {},

                // Time stats
                membershipDays: calculateMembershipDays(member.joinDate || member.joined),
                loginStreak: member.loginStreak || 0,

                // Special stats
                profileComplete: calculateProfileCompletion(member),
                founderStatus: member.founderStatus || 0,
                perfectWeeks: member.perfectWeeks || 0,
                winStreak: member.currentWinStreak || 0,
                seasonalBadges: member.seasonalBadges || [],

                // First win tracking
                hasFirstWin: member.firstWinDate ? true : false,

                // NEW: Leaderboard stats
                leaderboardPosition: member.leaderboardPosition || 999,
                leaderboardStreak: member.leaderboard1stStreak || 0,

                // NEW: Featured/Video stats
                featuredVideos: member.featuredVideos || 0,
                coachPicks: member.coachPicks || 0,
                videoOfWeek: member.videoOfWeekCount || 0,
                videoOfMonth: member.videoOfMonthCount || 0,
                viralVideos: member.viralVideos || 0,
                cinematicVideos: member.cinematicVideos || 0,
                trendingVideos: member.trendingVideos || 0,
                videoHallOfFame: member.videoHallOfFame || 0,

                // NEW: Helper stats
                membersHelped: member.membersHelped || 0,

                // NEW: DUPR rating
                duprRating: parseFloat(member.profile?.dupr) || 0,

                // NEW: Combo badges (tracked as array of unlocked combos)
                combosUnlocked: member.combosUnlocked || [],

                // NEW: Member number
                memberNumber: member.memberNumber || 99999,

                // NEW: Tips stats
                tipsSubmitted: member.tipsSubmitted || 0,
                featuredTips: member.featuredTips || 0,
                tipHallOfFame: member.tipHallOfFame || 0,

                // NEW: Shoutout stats
                shoutoutsReceived: member.shoutoutsReceived || 0,
                wallOfFame: member.wallOfFame || 0
            };

            let unlockedCount = 0;
            let totalCount = 0;

            // Process each badge
            document.querySelectorAll('.badge').forEach(badge => {
                totalCount++;
                const type = badge.dataset.type;
                const req = parseInt(badge.dataset.requirement);
                let unlocked = false;

                // Check unlock conditions based on badge type
                switch(type) {
                    case 'streak':
                        unlocked = stats.streak >= req;
                        break;
                    case 'completed':
                        unlocked = stats.completed >= req;
                        break;
                    case 'wins':
                        unlocked = stats.wins >= req;
                        break;
                    case 'submissions':
                        unlocked = stats.submissions >= req;
                        break;
                    case 'points':
                        unlocked = stats.points >= req;
                        break;
                    case 'spent':
                        unlocked = stats.spent >= req;
                        break;
                    case 'referrals':
                        unlocked = stats.referrals >= req;
                        break;
                    case 'votes':
                        unlocked = stats.votes >= req;
                        break;
                    case 'reactions':
                        unlocked = stats.reactions >= req;
                        break;
                    case 'reactionsReceived':
                        unlocked = stats.reactionsReceived >= req;
                        break;
                    case 'polls':
                        unlocked = stats.polls >= req;
                        break;
                    case 'partners':
                        unlocked = stats.partners >= req;
                        break;
                    case 'membership':
                        unlocked = stats.membershipDays >= req;
                        break;
                    case 'logins':
                        unlocked = stats.loginStreak >= req;
                        break;
                    case 'profile':
                        unlocked = stats.profileComplete >= req;
                        break;
                    case 'founder':
                        unlocked = stats.founderStatus >= req;
                        break;
                    case 'perfectWeek':
                        unlocked = stats.perfectWeeks >= req;
                        break;
                    case 'winStreak':
                        unlocked = stats.winStreak >= req;
                        break;
                    case 'seasonal':
                        unlocked = stats.seasonalBadges.includes(req);
                        break;
                    // Drill type badges
                    case 'drill-dinking':
                        unlocked = (stats.drillTypes.dinking || 0) >= req;
                        break;
                    case 'drill-thirdshot':
                        unlocked = (stats.drillTypes.thirdshot || 0) >= req;
                        break;
                    case 'drill-serve':
                        unlocked = (stats.drillTypes.serve || 0) >= req;
                        break;
                    case 'drill-volley':
                        unlocked = (stats.drillTypes.volley || 0) >= req;
                        break;
                    case 'drill-footwork':
                        unlocked = (stats.drillTypes.footwork || 0) >= req;
                        break;
                    case 'drill-lob':
                        unlocked = (stats.drillTypes.lob || 0) >= req;
                        break;
                    case 'drill-reset':
                        unlocked = (stats.drillTypes.reset || 0) >= req;
                        break;
                    case 'drill-atp':
                        unlocked = (stats.drillTypes.atp || 0) >= req;
                        break;
                    case 'drill-erne':
                        unlocked = (stats.drillTypes.erne || 0) >= req;
                        break;
                    case 'drill-speedup':
                        unlocked = (stats.drillTypes.speedup || 0) >= req;
                        break;

                    // NEW: Leaderboard badges
                    case 'leaderboard':
                        // For leaderboard, lower is better (position 1 is best)
                        unlocked = stats.leaderboardPosition <= req;
                        break;
                    case 'leaderboardStreak':
                        unlocked = stats.leaderboardStreak >= req;
                        break;

                    // NEW: Featured/Video badges
                    case 'featured':
                        unlocked = stats.featuredVideos >= req;
                        break;
                    case 'coachPick':
                        unlocked = stats.coachPicks >= req;
                        break;
                    case 'videoOfWeek':
                        unlocked = stats.videoOfWeek >= req;
                        break;
                    case 'videoOfMonth':
                        unlocked = stats.videoOfMonth >= req;
                        break;
                    case 'viralVideo':
                        unlocked = stats.viralVideos >= req;
                        break;
                    case 'cinematic':
                        unlocked = stats.cinematicVideos >= req;
                        break;
                    case 'trending':
                        unlocked = stats.trendingVideos >= req;
                        break;
                    case 'videoHallOfFame':
                        unlocked = stats.videoHallOfFame >= req;
                        break;

                    // NEW: Helper badges
                    case 'helper':
                        unlocked = stats.membersHelped >= req;
                        break;

                    // NEW: DUPR skill badges
                    case 'dupr':
                        const reqFloat = parseFloat(badge.dataset.requirement);
                        unlocked = stats.duprRating >= reqFloat;
                        break;

                    // NEW: Combo badges
                    case 'combo':
                        unlocked = stats.combosUnlocked.includes(req);
                        break;

                    // NEW: Member number badges (lower number = earlier member)
                    case 'memberNumber':
                        unlocked = stats.memberNumber <= req;
                        break;

                    // NEW: Tips badges
                    case 'tips':
                        unlocked = stats.tipsSubmitted >= req;
                        break;
                    case 'featuredTip':
                        unlocked = stats.featuredTips >= req;
                        break;
                    case 'tipHallOfFame':
                        unlocked = stats.tipHallOfFame >= req;
                        break;

                    // NEW: Shoutout badges
                    case 'shoutouts':
                        unlocked = stats.shoutoutsReceived >= req;
                        break;
                    case 'wallOfFame':
                        unlocked = stats.wallOfFame >= req;
                        break;

                    default:
                        // Secret/special badges - check member's unlocked badges array
                        if (member.unlockedBadges && member.unlockedBadges.includes(type + '-' + req)) {
                            unlocked = true;
                        }
                }

                // Apply unlock state
                if (unlocked) {
                    badge.classList.remove('locked');
                    unlockedCount++;

                    // Apply rarity class based on requirement difficulty
                    const rarity = getBadgeRarity(type, req);
                    badge.classList.add('rarity-' + rarity);
                } else {
                    badge.classList.add('locked');
                }
            });

            // Update progress display
            document.getElementById('badgesEarned').textContent = unlockedCount;
            document.getElementById('badgesTotal').textContent = totalCount;

            const progressPercent = totalCount > 0 ? (unlockedCount / totalCount * 100) : 0;
            document.getElementById('badgeProgressFill').style.width = progressPercent + '%';
        }

        function calculateMembershipDays(joinDate) {
            if (!joinDate) return 0;
            const joined = new Date(joinDate);
            const now = new Date();
            const diffTime = Math.abs(now - joined);
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        function calculateProfileCompletion(member) {
            let score = 0;
            if (member.name) score++;
            if (member.profile?.photo) score++;
            if (member.profile?.location) score++;
            if (member.profile?.dupr) score++;
            if (member.profile?.style) score++;
            if (member.profile?.availability) score++;
            if (member.profile?.social) score++;
            return score >= 6 ? 3 : (score >= 4 ? 2 : (score >= 2 ? 1 : 0));
        }

        function getBadgeRarity(type, requirement) {
            // Define rarity thresholds
            const rarityMap = {
                streak: { common: 4, uncommon: 12, rare: 26, epic: 52, legendary: 100 },
                completed: { common: 10, uncommon: 50, rare: 100, epic: 250, legendary: 500 },
                wins: { common: 5, uncommon: 15, rare: 50, epic: 100, legendary: 200 },
                points: { common: 500, uncommon: 2000, rare: 5000, epic: 10000, legendary: 50000 },
                referrals: { common: 3, uncommon: 10, rare: 25, epic: 50, legendary: 100 },
                membership: { common: 30, uncommon: 90, rare: 365, epic: 730, legendary: 1095 }
            };

            const thresholds = rarityMap[type] || { common: 5, uncommon: 15, rare: 30, epic: 75, legendary: 150 };

            if (requirement >= thresholds.legendary) return 'legendary';
            if (requirement >= thresholds.epic) return 'epic';
            if (requirement >= thresholds.rare) return 'rare';
            if (requirement >= thresholds.uncommon) return 'uncommon';
            return 'common';
        }

        function setupBadgeCategoryFilters() {
            const buttons = document.querySelectorAll('.badge-cat-btn');

            // Map parent group names to individual badge categories
            const groupMap = {
                progress: ['streak', 'challenge', 'contest', 'points', 'time'],
                social: ['social', 'helper'],
                skills: ['drills', 'skill', 'featured', 'leaderboard'],
                special: ['special', 'combo', 'member']
            };

            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');

                    const category = btn.dataset.category;

                    document.querySelectorAll('.badge').forEach(badge => {
                        if (category === 'all') {
                            badge.classList.remove('hidden');
                        } else {
                            const badgeCat = badge.dataset.category;
                            const matchCategories = groupMap[category] || [category];
                            if (matchCategories.includes(badgeCat)) {
                                badge.classList.remove('hidden');
                            } else {
                                badge.classList.add('hidden');
                            }
                        }
                    });
                });
            });
        }

        // ============================================
        // PARTNER FINDER
        // ============================================
        function loadPartners(filters = {}) {
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const currentEmail = localStorage.getItem('memberEmail');

            let filtered = members.filter(m =>
                m.active &&
                m.email.toLowerCase() !== currentEmail.toLowerCase() &&
                m.profile?.location &&
                m.profile?.social
            );

            // Apply filters
            if (filters.location) {
                const loc = filters.location.toLowerCase();
                filtered = filtered.filter(m =>
                    m.profile.location.toLowerCase().includes(loc)
                );
            }

            if (filters.skill) {
                filtered = filtered.filter(m => {
                    const dupr = parseFloat(m.profile?.dupr) || 0;
                    switch (filters.skill) {
                        case '3.0-3.5': return dupr >= 3.0 && dupr < 3.5;
                        case '3.5-4.0': return dupr >= 3.5 && dupr < 4.0;
                        case '4.0-4.5': return dupr >= 4.0 && dupr < 4.5;
                        case '4.5+': return dupr >= 4.5;
                        default: return true;
                    }
                });
            }

            const grid = document.getElementById('partnersGrid');

            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="no-partners">
                        <p>No members found matching your criteria.</p>
                        <p>Try broadening your search or check back later!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filtered.map(m => `
                <div class="partner-card">
                    <div class="partner-photo">
                        ${m.profile?.photo ? `<img src="${m.profile.photo}" alt="${m.name}">` : 'üë§'}
                    </div>
                    <div class="partner-info">
                        <h3>${m.name}</h3>
                        <p class="partner-location">${m.profile.location}</p>
                        <div class="partner-details">
                            ${m.profile.dupr ? `<span>DUPR: ${m.profile.dupr}</span>` : ''}
                            ${m.profile.style ? `<span>${m.profile.style}</span>` : ''}
                        </div>
                        <a href="${m.profile.social}" target="_blank" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.85rem;">Connect</a>
                    </div>
                </div>
            `).join('');
        }

        document.getElementById('searchPartners').addEventListener('click', () => {
            loadPartners({
                location: document.getElementById('filterLocation').value,
                skill: document.getElementById('filterSkill').value
            });
        });

        // ============================================
        // SPOTLIGHT
        // ============================================
        function loadSpotlight() {
            const spotlight = JSON.parse(localStorage.getItem('memberSpotlight'));

            if (spotlight) {
                document.getElementById('spotlightName').textContent = spotlight.name;
                document.getElementById('spotlightLocation').textContent = spotlight.location || '';
                document.getElementById('spotlightAchievement').textContent = spotlight.achievement || '';

                if (spotlight.photo) {
                    document.getElementById('spotlightPhoto').innerHTML = `<img src="${spotlight.photo}" alt="${spotlight.name}">`;
                }
            }
        }

        // ============================================
        // POINTS SYSTEM
        // ============================================
        const POINTS = {
            CHALLENGE_COMPLETE: 15,
            CONTEST_SUBMIT: 20,
            CONTEST_VOTE: 2,
            CONTEST_WIN: 50,
            STREAK_BONUS_4_WEEKS: 30,
            PROFILE_COMPLETE: 10
        };

        function addPoints(member, amount, reason) {
            member.points = (member.points || 0) + amount;
            member.pointsHistory = member.pointsHistory || [];
            member.pointsHistory.unshift({
                amount: amount,
                reason: reason,
                date: new Date().toISOString()
            });
            // Keep only last 50 history items
            if (member.pointsHistory.length > 50) {
                member.pointsHistory = member.pointsHistory.slice(0, 50);
            }
            return member;
        }

        function spendPoints(member, amount, reason) {
            if (member.points >= amount) {
                member.points -= amount;
                member.pointsHistory = member.pointsHistory || [];
                member.pointsHistory.unshift({
                    amount: -amount,
                    reason: reason,
                    date: new Date().toISOString()
                });
                return true;
            }
            return false;
        }

        function checkProfileComplete(profile) {
            return profile &&
                profile.location &&
                profile.dupr &&
                profile.style &&
                profile.courts &&
                profile.availability &&
                profile.bio;
        }

        // ============================================
        // REWARDS TAB
        // ============================================
        function loadRewards(member) {
            document.getElementById('rewardsPoints').textContent = member.points || 0;

            // Update redeem buttons based on points
            document.querySelectorAll('.redeem-btn').forEach(btn => {
                const cost = parseInt(btn.closest('.reward-card').dataset.cost);
                btn.disabled = (member.points || 0) < cost;
            });

            // Load history
            const historyEl = document.getElementById('pointsHistory');
            const history = member.pointsHistory || [];

            if (history.length === 0) {
                historyEl.innerHTML = '<p class="no-history">No points activity yet. Complete a challenge to start earning!</p>';
            } else {
                historyEl.innerHTML = history.slice(0, 20).map(item => `
                    <div class="history-item">
                        <span class="action">${item.reason}</span>
                        <span class="date">${new Date(item.date).toLocaleDateString()}</span>
                        <span class="${item.amount > 0 ? 'points-earned' : 'points-spent'}">${item.amount > 0 ? '+' : ''}${item.amount} pts</span>
                    </div>
                `).join('');
            }
        }

        // Redeem rewards
        document.querySelectorAll('.redeem-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const reward = this.dataset.reward;
                const cost = parseInt(this.closest('.reward-card').dataset.cost);
                const memberEmail = localStorage.getItem('memberEmail');
                const members = JSON.parse(localStorage.getItem('members') || '[]');
                const memberIndex = members.findIndex(m => m.email.toLowerCase() === memberEmail.toLowerCase());

                if (memberIndex === -1) return;

                const member = members[memberIndex];

                if ((member.points || 0) < cost) {
                    alert('Not enough points for this reward.');
                    return;
                }

                let rewardName = '';
                switch(reward) {
                    case 'drill-credit':
                        rewardName = 'Free AI Drill Analysis Credit';
                        break;
                    case 'discount-5':
                        rewardName = '$5 Discount Code';
                        break;
                    case 'analysis-30':
                        rewardName = 'Free 30-Min Video Analysis';
                        break;
                    case 'analysis-60':
                        rewardName = 'Free 60-Min Video Analysis';
                        break;
                }

                if (confirm(`Redeem ${rewardName} for ${cost} points?`)) {
                    spendPoints(member, cost, `Redeemed: ${rewardName}`);

                    // Store redemption
                    member.redemptions = member.redemptions || [];
                    member.redemptions.push({
                        reward: reward,
                        date: new Date().toISOString(),
                        claimed: false
                    });

                    localStorage.setItem('members', JSON.stringify(members));

                    alert(`Success! Your ${rewardName} has been redeemed. Ray will contact you with your reward code/details.`);

                    loadRewards(member);
                    loadProfile(member);
                }
            });
        });

        // ============================================
        // CHALLENGE VIDEO UPLOAD
        // ============================================
        document.getElementById('showUploadForm').addEventListener('click', function() {
            if (this.classList.contains('completed')) return;
            document.getElementById('challengeUploadForm').style.display = 'block';
            this.style.display = 'none';
        });

        function hideChallengeUpload() {
            document.getElementById('challengeUploadForm').style.display = 'none';
            document.getElementById('showUploadForm').style.display = 'inline-block';
        }

        function retryChallenge() {
            document.getElementById('verificationStatus').style.display = 'none';
            document.getElementById('challengeUploadForm').style.display = 'block';
            document.getElementById('verifiedFail').style.display = 'none';
            document.getElementById('verifyingState').style.display = 'flex';
        }

        document.getElementById('challengeVideoForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const videoLink = document.getElementById('challengeVideoLink').value;
            const drillType = document.getElementById('challengeDrillType').value;

            if (!videoLink || !drillType) {
                alert('Please fill in all fields.');
                return;
            }

            // Hide form, show verification status
            document.getElementById('challengeUploadForm').style.display = 'none';
            document.getElementById('verificationStatus').style.display = 'block';
            document.getElementById('verifyingState').style.display = 'flex';
            document.getElementById('verifiedSuccess').style.display = 'none';
            document.getElementById('verifiedFail').style.display = 'none';

            // Simulate AI verification (in production, this would call your API)
            // For now, we'll simulate a 3 second delay and auto-approve
            setTimeout(() => {
                const challenge = JSON.parse(localStorage.getItem('currentDrillChallenge'));
                const memberEmail = localStorage.getItem('memberEmail');
                const members = JSON.parse(localStorage.getItem('members') || '[]');
                const memberIndex = members.findIndex(m => m.email.toLowerCase() === memberEmail.toLowerCase());

                if (memberIndex > -1) {
                    const member = members[memberIndex];

                    // Store submission for admin review
                    member.challengeSubmissions = member.challengeSubmissions || [];
                    member.challengeSubmissions.push({
                        videoLink: videoLink,
                        drillType: drillType,
                        challengeTitle: challenge.title,
                        submittedAt: new Date().toISOString(),
                        weekEnding: challenge.weekEnding,
                        verified: true // In production, AI would set this
                    });

                    // Check if this continues their streak
                    const lastWeek = member.lastChallengeWeek;
                    const previousWeekEnd = new Date(challenge.weekEnding);
                    previousWeekEnd.setDate(previousWeekEnd.getDate() - 7);

                    let streakBonusEarned = false;
                    if (lastWeek === previousWeekEnd.toISOString()) {
                        member.challengeStreak = (member.challengeStreak || 0) + 1;
                        // Check for 4-week streak bonus
                        if (member.challengeStreak === 4 || member.challengeStreak % 4 === 0) {
                            streakBonusEarned = true;
                        }
                    } else if (lastWeek !== challenge.weekEnding) {
                        member.challengeStreak = 1;
                    }

                    member.lastChallengeWeek = challenge.weekEnding;
                    member.challengesCompleted = (member.challengesCompleted || 0) + 1;
                    member.longestStreak = Math.max(member.longestStreak || 0, member.challengeStreak);

                    // Award points
                    addPoints(member, POINTS.CHALLENGE_COMPLETE, 'Completed weekly challenge');
                    if (streakBonusEarned) {
                        addPoints(member, POINTS.STREAK_BONUS_4_WEEKS, '4-week streak bonus');
                    }

                    localStorage.setItem('members', JSON.stringify(members));

                    // Show success
                    document.getElementById('verifyingState').style.display = 'none';
                    document.getElementById('verifiedSuccess').style.display = 'block';
                    document.getElementById('verifiedSuccess').querySelector('p').textContent =
                        `+${POINTS.CHALLENGE_COMPLETE} points earned${streakBonusEarned ? ` (+${POINTS.STREAK_BONUS_4_WEEKS} streak bonus!)` : ''}`;

                    // Update UI
                    setTimeout(() => {
                        loadChallenges(member);
                        loadProfile(member);
                        loadRewards(member);
                    }, 2000);
                }
            }, 3000);
        });

        // Update loadMemberHub to include rewards
        function loadMemberHub() {
            const memberEmail = localStorage.getItem('memberEmail');
            if (!memberEmail) {
                document.getElementById('notLoggedIn').style.display = 'block';
                document.getElementById('memberContent').style.display = 'none';
                return;
            }

            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.email.toLowerCase() === memberEmail.toLowerCase() && m.active);

            if (!member) {
                document.getElementById('notLoggedIn').style.display = 'block';
                document.getElementById('memberContent').style.display = 'none';
                return;
            }

            document.getElementById('notLoggedIn').style.display = 'none';
            document.getElementById('memberContent').style.display = 'block';

            loadProfile(member);
            loadChallenges(member);
            loadRewards(member);
            loadPartners();
            loadSpotlight();
            loadQuickPoll(member);
            loadPartnerMatches(member);
            loadReferralCode(member);
        }

        // ============================================
        // QUICK POLLS
        // ============================================
        function loadQuickPoll(member) {
            const poll = JSON.parse(localStorage.getItem('quickPoll') || 'null');
            const pollSection = document.getElementById('quickPollSection');

            if (!poll || !poll.question || !poll.options) {
                pollSection.style.display = 'none';
                return;
            }

            pollSection.style.display = 'block';
            document.getElementById('pollQuestion').textContent = poll.question;

            const memberVote = localStorage.getItem('pollVote_' + poll.id);
            const optionsEl = document.getElementById('pollOptions');
            const resultsEl = document.getElementById('pollResults');

            if (memberVote) {
                // Show results
                optionsEl.style.display = 'none';
                resultsEl.style.display = 'block';
                showPollResults(poll);
            } else {
                // Show options
                optionsEl.style.display = 'flex';
                resultsEl.style.display = 'none';
                optionsEl.innerHTML = poll.options.map((opt, i) => `
                    <div class="poll-option" onclick="votePoll('${opt.name}', ${i})">${opt.name}</div>
                `).join('');
            }
        }

        function votePoll(optionName, index) {
            const poll = JSON.parse(localStorage.getItem('quickPoll'));
            if (!poll) return;

            poll.options[index].votes = (poll.options[index].votes || 0) + 1;
            localStorage.setItem('quickPoll', JSON.stringify(poll));
            localStorage.setItem('pollVote_' + poll.id, optionName);

            // Reload poll
            const memberEmail = localStorage.getItem('memberEmail');
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.email.toLowerCase() === memberEmail.toLowerCase());
            loadQuickPoll(member);
        }

        function showPollResults(poll) {
            const totalVotes = poll.options.reduce((sum, o) => sum + (o.votes || 0), 0);
            const resultsBar = document.getElementById('resultsBar');

            resultsBar.innerHTML = poll.options.map(opt => {
                const pct = totalVotes > 0 ? Math.round((opt.votes || 0) / totalVotes * 100) : 0;
                return `
                    <div class="result-bar">
                        <div class="result-label">
                            <span>${opt.name}</span>
                            <span>${pct}%</span>
                        </div>
                        <div class="result-fill">
                            <div class="result-fill-inner" style="width: ${pct}%"></div>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('totalVotes').textContent = `${totalVotes} total votes`;
        }

        // ============================================
        // PARTNER MATCH SUGGESTIONS
        // ============================================
        function loadPartnerMatches(currentMember) {
            const matchList = document.getElementById('matchList');

            if (!currentMember.profile?.dupr || !currentMember.profile?.availability) {
                matchList.innerHTML = '<p class="no-matches">Complete your profile (DUPR & availability) to see partner suggestions!</p>';
                return;
            }

            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const currentDupr = parseFloat(currentMember.profile.dupr) || 0;
            const currentAvail = (currentMember.profile.availability || '').toLowerCase();

            // Find matches
            const matches = members.filter(m => {
                if (m.email === currentMember.email) return false;
                if (!m.active) return false;
                if (!m.profile?.dupr) return false;

                const memberDupr = parseFloat(m.profile.dupr) || 0;
                const duprDiff = Math.abs(memberDupr - currentDupr);

                return duprDiff <= 0.5; // Within 0.5 DUPR
            }).map(m => {
                const memberDupr = parseFloat(m.profile.dupr) || 0;
                const memberAvail = (m.profile?.availability || '').toLowerCase();

                let reason = 'Similar skill level';
                if (currentAvail && memberAvail) {
                    // Check for availability overlap
                    const availWords = ['morning', 'afternoon', 'evening', 'weekend', 'weekday'];
                    const overlap = availWords.some(w => currentAvail.includes(w) && memberAvail.includes(w));
                    if (overlap) reason = 'Matching skill + availability';
                }

                return { ...m, reason };
            }).slice(0, 3);

            if (matches.length === 0) {
                matchList.innerHTML = '<p class="no-matches">No matches found yet. Check back as more members join!</p>';
                return;
            }

            matchList.innerHTML = matches.map(m => `
                <div class="match-item">
                    <div class="match-photo">${m.profile?.photo ? `<img src="${m.profile.photo}" alt="${m.name}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;">` : 'üë§'}</div>
                    <div class="match-info">
                        <div class="match-name">${m.name}</div>
                        <div class="match-details">DUPR ${m.profile?.dupr || '--'} ‚Ä¢ ${m.profile?.location || 'Location not set'}</div>
                        <span class="match-reason">${m.reason}</span>
                    </div>
                    ${m.profile?.social ? `<a href="${m.profile.social}" target="_blank" class="btn btn-secondary btn-small match-action">Connect</a>` : ''}
                </div>
            `).join('');
        }

        // ============================================
        // REFERRAL SYSTEM
        // ============================================
        // ============================================
        // ENHANCED REFERRAL SYSTEM
        // ============================================

        const REFERRAL_TIERS = {
            tiers: [
                { level: 1, required: 1, reward: "$5 off next month", value: 5, icon: "üéØ" },
                { level: 2, required: 3, reward: "Free month", value: 19.99, icon: "üåü" },
                { level: 3, required: 5, reward: "Free 30-min video analysis", value: 75, icon: "üé¨" },
                { level: 4, required: 10, reward: "Free 60-min video analysis", value: 120, icon: "üèÜ" },
                { level: 5, required: 15, reward: "Ambassador Status", value: "permanent", icon: "‚≠ê" }
            ],
            cycleResetAt: 15,
            ambassadorDiscount: 0.10,
            confirmationPeriodDays: 30
        };

        function loadReferralCode(member) {
            // Generate referral code from email
            const code = generateReferralCode(member.email);
            document.getElementById('referralCode').textContent = code;

            // Load enhanced referral dashboard
            loadReferralDashboard(member);
        }

        function generateReferralCode(email) {
            // Simple hash-based code
            let hash = 0;
            for (let i = 0; i < email.length; i++) {
                const char = email.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return 'RAY' + Math.abs(hash).toString(36).toUpperCase().slice(0, 5);
        }

        function loadReferralDashboard(member) {
            // Initialize referral data if not exists (migrate from old number format)
            if (!member.referrals || typeof member.referrals === 'number') {
                const oldCount = typeof member.referrals === 'number' ? member.referrals : 0;
                member.referrals = {
                    total: oldCount,
                    currentCycle: oldCount % 15,
                    pending: [],
                    confirmed: []
                };
            }

            // Initialize rewards tracking
            if (!member.referralRewards) {
                member.referralRewards = {
                    tier1Claimed: false,
                    tier2Claimed: false,
                    tier3Claimed: false,
                    tier4Claimed: false,
                    tier5Achieved: false,
                    claimHistory: []
                };
            }

            // Check and confirm pending referrals
            checkPendingReferrals(member);

            // Update progress visualization
            updateTierProgress(member);

            // Update tier statuses
            updateTierStatuses(member);

            // Show/hide legendary ambassador badge
            updateAmbassadorStatus(member);

            // Display pending referrals
            displayPendingReferrals(member);
        }

        function checkPendingReferrals(member) {
            const now = new Date();
            const pending = member.referrals.pending || [];
            const toConfirm = [];
            const stillPending = [];

            pending.forEach(ref => {
                const confirmDate = new Date(ref.confirmsAt);
                if (now >= confirmDate) {
                    toConfirm.push(ref);
                } else {
                    stillPending.push(ref);
                }
            });

            // Process confirmations
            if (toConfirm.length > 0) {
                toConfirm.forEach(ref => {
                    member.referrals.confirmed.push({
                        ...ref,
                        confirmedAt: now.toISOString()
                    });
                    member.referrals.total++;
                    member.referrals.currentCycle++;

                    // Award points
                    member.points = (member.points || 0) + 50;
                    member.pointsHistory = member.pointsHistory || [];
                    member.pointsHistory.unshift({
                        amount: 50,
                        reason: `Referral confirmed: ${ref.referredName}`,
                        date: now.toISOString()
                    });

                    // Check for Ambassador status
                    if (member.referrals.currentCycle >= 15 && !member.isAmbassador) {
                        member.isAmbassador = true;
                        member.ambassadorSince = now.toISOString();
                        member.referralRewards.tier5Achieved = true;
                        // Reset cycle for ambassadors to earn again
                        member.referrals.currentCycle = 0;
                        member.referralRewards.tier1Claimed = false;
                        member.referralRewards.tier2Claimed = false;
                        member.referralRewards.tier3Claimed = false;
                        member.referralRewards.tier4Claimed = false;
                    }
                });

                member.referrals.pending = stillPending;
                saveMember(member);
            }
        }

        function updateTierProgress(member) {
            const cycleCount = member.referrals.currentCycle || 0;
            const maxTier = 15;
            const percentage = Math.min((cycleCount / maxTier) * 100, 100);

            const tierFill = document.getElementById('tierFill');
            if (tierFill) {
                tierFill.style.width = `${percentage}%`;
            }

            const progressCount = document.getElementById('referralProgressCount');
            if (progressCount) {
                const remaining = maxTier - cycleCount;
                const progressText = member.isAmbassador
                    ? `${cycleCount}/15 (Ambassador - earning again!)`
                    : `${cycleCount}/15 to Ambassador`;
                progressCount.textContent = progressText;
            }

            // Update tier markers
            document.querySelectorAll('.tier-marker').forEach(marker => {
                const req = parseInt(marker.dataset.req);
                if (cycleCount >= req) {
                    marker.classList.add('achieved');
                } else {
                    marker.classList.remove('achieved');
                }
            });
        }

        function updateTierStatuses(member) {
            const cycleCount = member.referrals.currentCycle || 0;
            const rewards = member.referralRewards || {};

            REFERRAL_TIERS.tiers.forEach(tier => {
                const statusEl = document.getElementById(`tier${tier.level}Status`);
                const rowEl = document.querySelector(`.tier-row[data-tier="${tier.level}"]`);

                if (!statusEl || !rowEl) return;

                if (cycleCount >= tier.required || (tier.level === 5 && member.isAmbassador)) {
                    rowEl.classList.add('unlocked');

                    if (tier.level === 5) {
                        statusEl.textContent = member.isAmbassador ? '‚úì LEGENDARY' : 'Unlocked!';
                        statusEl.className = 'tier-status' + (member.isAmbassador ? ' achieved' : ' ready');
                    } else {
                        const claimKey = `tier${tier.level}Claimed`;
                        if (rewards[claimKey]) {
                            statusEl.textContent = '‚úì Claimed';
                            statusEl.className = 'tier-status claimed';
                        } else {
                            statusEl.textContent = 'Ready to Claim!';
                            statusEl.className = 'tier-status ready';
                        }
                    }
                } else {
                    rowEl.classList.remove('unlocked');
                    statusEl.textContent = `${tier.required - cycleCount} more`;
                    statusEl.className = 'tier-status';
                }
            });
        }

        function updateAmbassadorStatus(member) {
            const badge = document.getElementById('ambassadorBadge');
            if (badge) {
                if (member.isAmbassador) {
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        function displayPendingReferrals(member) {
            const pending = member.referrals.pending || [];
            const container = document.getElementById('pendingReferrals');
            const list = document.getElementById('pendingReferralsList');

            if (!container || !list) return;

            if (pending.length === 0) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            list.innerHTML = pending.map(ref => {
                const confirmsAt = new Date(ref.confirmsAt);
                const daysLeft = Math.ceil((confirmsAt - new Date()) / (1000 * 60 * 60 * 24));
                return `
                    <div class="pending-item">
                        <span class="pending-name">${ref.referredName}</span>
                        <span class="pending-timer">${daysLeft} days left</span>
                    </div>
                `;
            }).join('');
        }

        function copyReferralCode() {
            const code = document.getElementById('referralCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('Referral code copied: ' + code);
            });
        }

        // Share functions
        function shareViaText() {
            const code = document.getElementById('referralCode').textContent;
            const message = `Join Ray's Pickleball community! Use my code ${code} when you sign up: https://rayspickleball.com/membership.html?ref=${code}`;
            window.open(`sms:?body=${encodeURIComponent(message)}`);
        }

        function shareViaEmail() {
            const code = document.getElementById('referralCode').textContent;
            const subject = "Join me on Ray's Pickleball!";
            const body = `Hey!\n\nI've been loving Ray's Pickleball community - the AI drill coach and video analysis are game changers!\n\nUse my referral code ${code} when you sign up and we'll both get rewards.\n\nSign up here: https://rayspickleball.com/membership.html?ref=${code}`;
            window.open(`mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);
        }

        function copyShareLink() {
            const code = document.getElementById('referralCode').textContent;
            const link = `https://rayspickleball.com/membership.html?ref=${code}`;
            navigator.clipboard.writeText(link).then(() => {
                alert('Share link copied!\n' + link);
            });
        }

        function saveMember(member) {
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const index = members.findIndex(m => m.email.toLowerCase() === member.email.toLowerCase());
            if (index > -1) {
                members[index] = member;
                localStorage.setItem('members', JSON.stringify(members));
            }
        }

        // Legacy function for backwards compatibility
        function processReferral(referralCode) {
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const referrer = members.find(m => generateReferralCode(m.email) === referralCode);
            if (referrer) {
                const memberIndex = members.findIndex(m => m.email === referrer.email);
                if (memberIndex > -1) {
                    members[memberIndex].points = (members[memberIndex].points || 0) + 50;
                    members[memberIndex].pointsHistory = members[memberIndex].pointsHistory || [];
                    members[memberIndex].pointsHistory.unshift({
                        amount: 50,
                        reason: 'Referral bonus - friend joined!',
                        date: new Date().toISOString()
                    });
                    members[memberIndex].referrals = (members[memberIndex].referrals || 0) + 1;
                    localStorage.setItem('members', JSON.stringify(members));
                    return true;
                }
            }
            return false;
        }

        // ============================================
        // GAMIFICATION INTEGRATION
        // ============================================

        // Initialize gamification and social modules
        async function initGamification() {
            // Initialize modules
            if (typeof Gamification !== 'undefined') {
                Gamification.init();
            }
            if (typeof Social !== 'undefined') {
                Social.init();
            }

            // Check if user is logged in via Supabase
            const supabase = getSupabaseClient();
            if (!supabase) return;

            const { data: { user } } = await supabase.auth.getUser();
            if (!user) return;

            // Load gamification dashboard
            await loadGamificationDashboard(user);
        }

        async function loadGamificationDashboard(user) {
            try {
                // Get gamification stats
                const gamificationData = await Gamification.getStats();

                // Update welcome name
                const welcomeName = document.getElementById('welcomeName');
                if (welcomeName) {
                    welcomeName.textContent = user.user_metadata?.full_name?.split(' ')[0] || 'Player';
                }

                // Render XP bar
                Gamification.renderXPBar('#xpBarContainer', gamificationData.stats, gamificationData.levelProgress);

                // Render stats overview
                Gamification.renderStatsOverview('#statsOverviewContainer', gamificationData.stats);

                // Render streak calendar
                Gamification.renderStreakCalendar('#streakCalendarContainer', gamificationData.streakCalendar);

                // Render badges
                const allBadges = await Gamification.getAllBadges();
                Gamification.renderBadges('#badgesContainer', gamificationData.badges, allBadges.badges);

                // Render recent XP transactions
                renderRecentXP(gamificationData.recentXP);

                // Setup checkin button
                setupCheckinButton(gamificationData.stats);

                // Load leaderboard
                const leaderboardData = await Gamification.getLeaderboard('alltime', 10);
                Gamification.renderLeaderboard('#leaderboardContainer', leaderboardData.leaderboard, user.id);

                // Update rank card
                updateYourRank(leaderboardData.leaderboard, user.id, gamificationData.stats);

                // Load activity feed
                const activityData = await Gamification.getActivityFeed(10);
                Gamification.renderActivityFeed('#activityFeedContainer', activityData.activities);

                // Load progress data
                const progressData = await Social.getProgress();
                Social.renderProgressChart('#progressChartContainer', progressData);

                // Update personal stats
                document.getElementById('totalVideosAnalyzed').textContent = progressData.totalVideosAnalyzed || 0;
                document.getElementById('longestStreakStat').textContent = gamificationData.stats.longestStreak || 0;

            } catch (error) {
                console.error('Error loading gamification dashboard:', error);
            }
        }

        function renderRecentXP(transactions) {
            const container = document.getElementById('recentXPContainer');
            if (!container || !transactions || transactions.length === 0) return;

            container.innerHTML = transactions.map(tx => `
                <div class="recent-xp-item">
                    <div>
                        <span class="xp-action">${tx.description || tx.action_type}</span>
                        <span class="xp-time">${Gamification.formatTimeAgo(tx.created_at)}</span>
                    </div>
                    <span class="xp-amount">+${tx.xp_amount} XP</span>
                </div>
            `).join('');
        }

        function setupCheckinButton(stats) {
            const checkinBtn = document.getElementById('checkinBtn');
            const checkinMessage = document.getElementById('checkinMessage');

            if (!checkinBtn) return;

            // Check if already checked in today
            const today = new Date().toISOString().split('T')[0];
            const alreadyCheckedIn = stats.lastLoginDate === today;

            if (alreadyCheckedIn) {
                checkinBtn.innerHTML = '<span class="btn-icon">‚úì</span> Checked In!';
                checkinBtn.classList.add('checked-in');
                checkinBtn.disabled = true;
                if (checkinMessage) {
                    checkinMessage.textContent = `üî• ${stats.currentStreak}-day streak! Keep it up!`;
                }
            } else {
                checkinBtn.addEventListener('click', async () => {
                    checkinBtn.disabled = true;
                    checkinBtn.innerHTML = '<span class="btn-icon">‚è≥</span> Checking in...';

                    try {
                        await Gamification.showCheckinModal();

                        // Update button state
                        checkinBtn.innerHTML = '<span class="btn-icon">‚úì</span> Checked In!';
                        checkinBtn.classList.add('checked-in');

                        // Reload dashboard to reflect new stats
                        const supabase = getSupabaseClient();
                        const { data: { user } } = await supabase.auth.getUser();
                        if (user) {
                            await loadGamificationDashboard(user);
                        }
                    } catch (error) {
                        console.error('Checkin error:', error);
                        checkinBtn.disabled = false;
                        checkinBtn.innerHTML = '<span class="btn-icon">üî•</span> Check In Today';
                    }
                });
            }
        }

        function updateYourRank(leaderboard, userId, stats) {
            const yourRankEl = document.getElementById('yourRank');
            const yourXPEl = document.getElementById('yourTotalXP');
            const rankMessageEl = document.getElementById('rankMessage');

            const myEntry = leaderboard.find(e => e.userId === userId);
            const myRank = myEntry ? myEntry.rank : '--';

            if (yourRankEl) yourRankEl.textContent = `#${myRank}`;
            if (yourXPEl) yourXPEl.textContent = `${Gamification.formatNumber(stats.totalXP)} XP`;

            if (rankMessageEl) {
                if (myRank === 1) {
                    rankMessageEl.textContent = "üèÜ You're #1! Amazing work!";
                } else if (myRank <= 3) {
                    rankMessageEl.textContent = "ü•á Top 3! You're crushing it!";
                } else if (myRank <= 10) {
                    rankMessageEl.textContent = "Top 10! Keep climbing!";
                } else {
                    rankMessageEl.textContent = "Keep earning XP to climb the ranks!";
                }
            }
        }

        // Update the switchTab function to handle new tabs
        const originalSwitchTab = typeof switchTab === 'function' ? switchTab : null;
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
                tab.style.display = 'none';
            });

            // Show selected tab
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
                selectedTab.style.display = 'block';
            }

            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabName) {
                    btn.classList.add('active');
                }
            });
        }

        // Setup tab navigation
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                switchTab(btn.dataset.tab);
            });
        });

        // Initialize
        loadMemberHub();

        // Initialize gamification after page loads
        document.addEventListener('DOMContentLoaded', () => {
            initGamification();
        });
    </script>
</body>
</html>
